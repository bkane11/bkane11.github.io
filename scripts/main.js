function showloading(){$(".appName").addClass("loading")}function hideloading(){$(".appName.loading").removeClass("loading")}function switch_tab(e){for(var t=document.getElementsByTagName("div"),n=0;n<t.length;n++){var o=t[n];"model_container"==o.className&&(o.style.display=o.id=="Data_"+e?"block":"none")}var a=document.getElementsByTagName("td");for(n=0;n<a.length;n++){var i=a[n];if("selected"==i.className){i.className="tab";break}}document.getElementById("Tab_"+e).className="selected"}function toggle_extra_info(){for(var e=document.getElementsByTagName("tr"),t=0;t<e.length;t++){var n=e[t];"extra_info"==n.id&&(n.style.display="none"==n.style.display?"":"none")}for(var o=document.getElementsByName("additional_data"),t=0;t<o.length;t++){var a=o[t];a.innerHTML="Show Additional Data"==a.innerHTML?"Hide Additional Data":"Show Additional Data"}}function switch_extended(){var e=document.getElementById("Extended_Native"),t=document.getElementById("Extended_Hourly"),n=document.getElementById("switch_extended");"block"==e.style.display?(e.style.display="none",t.style.display="block",n.innerHTML="Fewer Hours",document.cookie="qlvt=1;expires=Tue, 31 Dec 2030 00:00:00 UTC"):(e.style.display="block",t.style.display="none",n.innerHTML="More Hours",document.cookie="qlvt=0;expires=Tue, 31 Dec 2030 00:00:00 UTC")}function loadMeteogram(e,t){showloading(),e=$(e),$.getJSON("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22"+encodeURIComponent(t)+"%22&format=xml'&callback=?",function(t){if(t.results[0]){var t=filterData(t.results[0]),n=$(t).find(".meteogram");e.html(n).css("margin-bottom","-100px"),n.find(" > :not(table, .heading, .model_container)").remove(),$(".leaflet-popup-content").width(500)}else{var o="<p>Error: could not load the page.</p>";e.html(o)}hideloading()})}function filterData(e){return e=e.replace(/<?\/body[^>]*>/g,""),e=e.replace(/[\r|\n]+/g,""),e=e.replace(/<--[\S\s]*?-->/g,""),e=e.replace(/<noscript[^>]*>[\S\s]*?<\/noscript>/g,""),e=e.replace(/<script[^>]*>[\S\s]*?<\/script>/g,""),e=e.replace(/<script.*\/>/,""),e=e.replace(/src="/g,'src="http://www.iwindsurf.com/')}var app=window.app=app||{},vendorprefix=function(){var e=window.getComputedStyle(document.documentElement,""),t=(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1],n="WebKit|Moz|MS|O".match(new RegExp("("+t+")","i"))[1];return{dom:n,lowercase:t,css:"-"+t+"-",js:t[0].toUpperCase()+t.substr(1)}}();!function(e,t,n,o){"use strict";function a(){var e=m.getBounds();return c+"&minLat="+e.getSouth()+"&minLon="+e.getWest()+"&maxLat="+e.getNorth()+"&maxLon="+e.getEast()+"&zoomLevel="+m.getZoom()}function i(e){e=e||o.stations,e&&m.removeLayer(e)}function s(){return n.layerGroup().addTo(m)}function r(e){if("abort"!==e.statusText){i();var t=o.stations=s(),a=JSON.parse(JSON.parse(e.responseText).error.split("//Total time:")[0]);$.each(a,function(){var e=this.sensorReadings.length>0?this.sensorReadings[0].direction:"",o=this.sensorReadings.length>0?this.sensorReadings[0].average:"",a=this.sensorReadings.length>0?this.sensorReadings[0].gust:"",i=this.fullName||"",s=this.fullName||"",r=e+(o?", avg: "+o:"")+(a?", gust: "+a:"");if(r){var d,l=2*(parseFloat(o)||1),c=a?2*parseFloat(a):l,p='<div class="trans" title="'+s+" "+(r||"no data")+'" style="font-size:'+l+'px; ">&#10148;</div>';(-1!==e.indexOf("E")||"N"===e)&&(d="green"),-1!==e.indexOf("W")&&(d="red"),d||(d="gray");var u=n.divIcon({html:p,iconsSize:[l,l],iconAnchor:[l/2-3,l],className:["direction",e,d].join(" ")}),h="http://www.iwindsurf.com/windandwhere.iws?regionID=1669&ISection=Forecast+Graphs&location_id="+this.id,g=$('<div class="meteogram-container"></div>'),f=$('<a class="showmeteogram">Show Meteogram</a>').on("click",function(){loadMeteogram(g,h)}),v=$("<div><h3>"+i+"</h3></div>").append(r).append('<a target="_blank" href="'+h+'"> forecast </a>').append(f).append(g),w=n.marker([this.baseLat,this.baseLon],{icon:u}).bindPopup(v[0]).on("mouseover",function(){this.infocus=!0;$(this._icon).find("div").css("text-shadow",d+" "+(c-l)+"px 0px 0px")}).on("mouseout",function(){this.infocus=!1;$(this._icon).find("div").css("text-shadow","")}).addTo(t);setTimeout(function(){var e=setInterval(function(){(!w||w&&!m.hasLayer(w))&&clearInterval(e);var t;w.infocus||(t=w._gusted||0),t=2===t?0:t+=1,$(w._icon).find("div").css("text-shadow",-1!==[2,0].indexOf(t)?"transparent "+(c-l)*t+"px 0px 0px":d+" "+(c-l)*t+"px 0px 0px"),w._gusted=t},1e3)},Math.round(3e3*Math.random())+1)}}),hideloading()}}function d(e){o.ajaxCall&&o.ajaxCall.abort(),o.ajaxCall=$.get(p+encodeURIComponent(e),r).success(function(e){r(e)}).error(function(e){r(e)})}function l(){return m.hasPopup?!1:(showloading(),void d(a()))}var c=(vendorprefix.css+"transform","http://www.iwindsurf.com/json/dyn_weatherstation.php?region_id=1669&units=mph&tunits=F"),p="https://jsonp.nodejitsu.com/?url=",m=o.map=n.map("map",{center:[37.83853,-122.39182],zoom:10,minZoom:8}).on("popupopen",function(){this.hasPopup=!0}).on("popupclose",function(){this.hasPopup=!1}).on("moveend",l).on("zoomend",l);n.control.locate().addTo(m),l();new n.tileLayer("http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.png",{minZoom:0,maxZoom:20,maxNativeZoom:18,attribution:'Map data Â© <a href="http://www.openstreetmap.org">OpenStreetMap contributors</a>'}).addTo(m);o.reloadInterval=setInterval(l,6e4)}(window,document,L,app);