function MarkerManager(a,b){var c=this;c.map_=a,c.mapZoom_=a.getZoom(),c.projectionHelper_=new ProjectionHelperOverlay(a),google.maps.event.addListener(c.projectionHelper_,"ready",function(){c.projection_=this.getProjection(),c.initialize(a,b)})}function GridBounds(a){this.minX=Math.min(a[0].x,a[1].x),this.maxX=Math.max(a[0].x,a[1].x),this.minY=Math.min(a[0].y,a[1].y),this.maxY=Math.max(a[0].y,a[1].y)}function ProjectionHelperOverlay(a){this.setMap(a);this._map=a,this._zoom=-1,this._X0=this._Y0=this._X1=this._Y1=-1}function ClusterIcon(a,b){a.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.cluster_=a,this.styles_=b,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(a.getMap())}function Cluster(a){this.markerClusterer_=a,this.map_=a.getMap(),this.gridSize_=a.getGridSize(),this.minClusterSize_=a.getMinimumClusterSize(),this.averageCenter_=a.getAverageCenter(),this.printable_=a.getPrintable(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,a.getStyles())}function MarkerClusterer(a,b,c){this.extend(MarkerClusterer,google.maps.OverlayView),b=b||[],c=c||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=c.gridSize||60,this.minClusterSize_=c.minimumClusterSize||2,this.maxZoom_=c.maxZoom||null,this.styles_=c.styles||[],this.title_=c.title||"",this.zoomOnClick_=!0,void 0!==c.zoomOnClick&&(this.zoomOnClick_=c.zoomOnClick),this.averageCenter_=!1,void 0!==c.averageCenter&&(this.averageCenter_=c.averageCenter),this.ignoreHidden_=!1,void 0!==c.ignoreHidden&&(this.ignoreHidden_=c.ignoreHidden),this.printable_=!1,void 0!==c.printable&&(this.printable_=c.printable),this.imagePath_=c.imagePath||MarkerClusterer.IMAGE_PATH,this.imageExtension_=c.imageExtension||MarkerClusterer.IMAGE_EXTENSION,this.imageSizes_=c.imageSizes||MarkerClusterer.IMAGE_SIZES,this.calculator_=c.calculator||MarkerClusterer.CALCULATOR,this.batchSize_=c.batchSize||MarkerClusterer.BATCH_SIZE,this.batchSizeIE_=c.batchSizeIE||MarkerClusterer.BATCH_SIZE_IE,-1!==navigator.userAgent.toLowerCase().indexOf("msie")&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(b,!0),this.setMap(a)}function searchLayers(a,b){searching=!0;var c=this.value.trim(),d=c.toLowerCase(),e=[];if(13==a.keyCode&&$(".pac-container").show(),!c||c.length<3)return searching=!1;showLoading("<span>searching layers for: "+c+"</span>");for(var f in b)if((-1!==f.toLowerCase().indexOf(d)||-1!==d.indexOf(f.toLowerCase())&&-1===e.indexOf({name:f+" - All Features",layer:b[f]}))&&e.push({name:f+" - All Features",layer:b[f]}),b[f].sublayers)for(var g in b[f].sublayers)(-1!==g.toLowerCase().indexOf(d)||-1!==d.indexOf(g.toLowerCase())&&-1===e.indexOf({name:g,layer:b[f].sublayers[g]}))&&e.push({name:g,layer:b[f].sublayers[g]});b instanceof Array&&b.forEach(function(a){a.sublayers?objectforeach(a.sublayers,function(a){searchLayer(a,d,e)}):searchLayer(a,d,e)}),b instanceof Object&&objectforeach(b,function(a){searchLayer(a,d,e),a.sublayers?objectforeach(a.sublayers,function(a){searchLayer(a,d,e)}):objectforeach(a,function(a){searchLayer(a,d,e)})}),showResults(e,c),searching=!1}function showResults(a,b){willshow&&clearTimeout(willshow),willshow=setTimeout(function(){searching||(clearLayerResults(),a.slice(0,200).forEach(function(a){var c="";a.getProperty instanceof Function&&(c=(a.getProperty("site_name")||"")+" "+(a.getProperty("complex_id")||"")),a.properties&&(c=(a.properties.site_name||"")+" "+(a.properties.complex_id||""),c=c.trim());var d={label:(c||a.info||a.properties&&a.properties.info||a.name||a.properties&&a.properties.NAME||a.properties&&a.properties.Type+" - "+a.properties.Name).trim(),feature:a.layer||a};addResultToPACContainer(b,d)}),hideLoading())},1e3)}function clearLayerResults(){$(".pac-container .layerresult").remove()}function searchLayer(a,b,c){return c=c||[],a.json&&a.json.features.forEach(function(d){d.getLayer=function(){return a},searchProperties(d,b,c)}),a.properties&&searchProperties(a,b,c),a instanceof Array&&a.forEach(function(a){searchProperties(a,b,c)}),c}function searchProperties(a,b,c){return objectforeach(a.properties,function(d){if(b&&d&&d.toLowerCase instanceof Function){var e=b.split(" ");if(e.length<2)-1!==d.toLowerCase().indexOf(b)&&-1===c.indexOf(a)&&c.push(a);else{var f;for(var g in e){var h=e[g];if(-1===d.toLowerCase().indexOf(h)){f=!1;break}f=!0}f&&-1===c.indexOf(a)&&c.push(a)}}}),c}function bestMatch(a,b){var c=b.split(" ");return c.length>1?a.sort(function(a,b){var d,e;return objectforeach(a.properties,function(a){for(var b in c){var e=c[b];if(-1===a.toLowerCase().indexOf(e))return d=!1}}),objectforeach(b.properties,function(a){for(var b in c){var d=c[b];if(-1===a.toLowerCase().indexOf(d))return e=!1}}),d&&!e?1:e&&!d?-1:0}):a}function addResultToPACContainer(a,b){var c=$("#results"),d=c.find(".pac-matched:contains("+b.label+")");if(d.length>0){var e;if(d.each(function(){$(this).text()===b.label&&(e=!0)}),e)return console.log("already a result for",b.label)}item=$('<div class="pac-item layerresult"><span class="pac-icon pac-icon-marker"></span><span class="pac-matched">'+b.label+"</span></div>"),c.append(item),b.onclick instanceof Function?item.on("click",b.onclick.bind(item[0],item[0])):item.on("click",function(){showLoading("<span>loading: "+b.label+"</span>"),changeSelectedResultItem(this);{var a;$("#searchTextField").addClass("focused")}if(b.feature.getMap instanceof Function&&(b.feature.getCheckbox instanceof Function&&!b.feature.getMap()&&b.feature.getCheckbox().trigger("click"),zoomToLayer(b.feature)),b.feature.getLayer instanceof Function){zoomToResult(b.feature),a=b.feature.getLayer(),a&&!a.getMap()&&a.getCheckbox instanceof Function&&a.getCheckbox().trigger("click");var c=getFeatureMatch(b.feature,a);return openInfoWindow(c,a),b}}),(c.hasClass("hidden")||"none"===c.css("display"))&&switchLeftPaneContent({showitem:c,name:"Results"}),hideLoading()}function getFeatureMatch(a,b){var c;return b.forEach(function(b){if(!c)for(var d in a.properties){if(b.getProperty(d)!==a.properties[d]){c=!1;break}c=b}}),c}function clearSelection(){selectedShape&&(selectedShape.setEditable(!1),selectedShape=null)}function setSelection(a){clearSelection(),selectedShape=a,a.setEditable(!0)}function enableDrawing(a){var b=[],c=new google.maps.drawing.DrawingManager({drawingControl:!0,editable:!0,drawingControlOptions:{position:google.maps.ControlPosition.BOTTOM_CENTER,drawingModes:[google.maps.drawing.OverlayType.POLYGON,google.maps.drawing.OverlayType.POLYLINE]}});c.layers=b,google.maps.event.addListener(c,"overlaycomplete",function(a){if(b.push(a),onOverlayAdd(b,e,d),a.type!=google.maps.drawing.OverlayType.MARKER){c.setDrawingMode(null);var f=a.overlay;f.type=a.type,google.maps.event.addListener(f,"click",function(){setSelection(f)}),setSelection(f),b.filter(function(a){return!a.overlay.getMap()}).forEach(function(a){b.splice(b.indexOf(a),1)})}});var d=$('<div class="drawingControls deleteAll gmnoprint" title="Delete all drawings"><b>X</b></div>').css("padding","5px 0").addClass("hidden"),e=$('<div class="drawingControls deleteLast gmnoprint" title="Remove last drawing"></div>').css("padding","5px 0").addClass("hidden"),f=$('<div class="drawingControls showLast gmnoprint" title="Undo remove drawing"></div>').css("padding","5px 0").addClass("hidden"),g=$("<div></div>").addClass("drawingControlsContainer").append(d).append(e).append(f);return window.ieclass&&parseInt(ieclass)<9&&(e.append('<img src="http://maps.gstatic.com/mapfiles/undo_poly.png"/>').css({border:"1px solid #999",height:"12px"}),f.append('<img src="http://maps.gstatic.com/mapfiles/undo_poly.png"/>').css({border:"1px solid #999",height:"12px"}),g.css("margin-bottom","-5px").css("height","28px")),a.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(g[0]),c.setMap(a),google.maps.event.addDomListener(d[0],"click",function(){deleteAllShapes(b,d,e,f)}),google.maps.event.addDomListener(e[0],"click",function(){var c=deleteLastShape(b,a);0===c&&e.addClass("hidden"),f.removeClass("hidden")}),google.maps.event.addDomListener(f[0],"click",function(){var c=showLastShape(b,a);c&&c!==b.length||f.addClass("hidden"),e.removeClass("hidden")}),this}function onOverlayAdd(a,b,c){var d=a.length;d>0&&(b.removeClass("hidden"),c.removeClass("hidden"))}function deleteAllShapes(a,b,c,d){for(var e=0;e<a.length;e++)a[e].overlay.setMap(null);a=[],b.addClass("hidden"),c.addClass("hidden"),d.addClass("hidden")}function deleteLastShape(a){for(var b=a.length-1;b>-1;b--)if(a[b].overlay.getMap())return a[b].overlay.setMap(null),b}function showLastShape(a,b){for(var c=a.length-1;c>-1;c--)if(!a[c].overlay.getMap())return a[c].overlay.setMap(b),c}function addRegions(){var a=[new google.maps.LatLng(48.516604,-124.716797),new google.maps.LatLng(48.458352,-124.365234),new google.maps.LatLng(48.400032,-123.75),new google.maps.LatLng(48.69096,-123.222656),new google.maps.LatLng(49.095452,-123.222656),new google.maps.LatLng(48.980217,-104.0625),new google.maps.LatLng(45.274886,-104.0625),new google.maps.LatLng(45.089036,-111.005859),new google.maps.LatLng(41.178654,-111.181641),new google.maps.LatLng(41.046217,-109.160156),new google.maps.LatLng(37.160317,-109.160156),new google.maps.LatLng(31.578535,-109.072266),new google.maps.LatLng(31.353637,-109.160156),new google.maps.LatLng(31.428663,-111.09375),new google.maps.LatLng(32.398516,-114.697266),new google.maps.LatLng(32.62087,-117.158203),new google.maps.LatLng(33.72434,-118.212891),new google.maps.LatLng(34.307144,-119.267578),new google.maps.LatLng(34.452218,-120.498047),new google.maps.LatLng(35.675147,-121.464844),new google.maps.LatLng(37.09024,-122.519531),new google.maps.LatLng(38.479395,-123.662109),new google.maps.LatLng(40.380028,-124.277344),new google.maps.LatLng(42.875964,-124.541016),new google.maps.LatLng(45.39845,-124.101563),new google.maps.LatLng(47.040182,-124.365234),new google.maps.LatLng(47.989922,-124.716797),new google.maps.LatLng(48.400032,-124.980469)],b=[new google.maps.LatLng(44.964798,-104.238281),new google.maps.LatLng(49.037868,-103.974609),new google.maps.LatLng(48.980217,-101.337891),new google.maps.LatLng(49.15297,-95.361328),new google.maps.LatLng(48.922499,-94.482422),new google.maps.LatLng(48.57479,-92.8125),new google.maps.LatLng(48.224673,-91.142578),new google.maps.LatLng(48.04871,-89.912109),new google.maps.LatLng(46.800059,-92.109375),new google.maps.LatLng(46.980252,-90.966797),new google.maps.LatLng(46.679594,-90.791016),new google.maps.LatLng(46.800059,-89.736328),new google.maps.LatLng(47.398349,-88.066406),new google.maps.LatLng(46.920255,-88.154297),new google.maps.LatLng(46.890232,-87.890625),new google.maps.LatLng(46.619261,-87.539063),new google.maps.LatLng(46.498392,-87.011719),new google.maps.LatLng(46.498392,-86.52832),new google.maps.LatLng(46.679594,-86.044922),new google.maps.LatLng(46.800059,-84.990234),new google.maps.LatLng(46.589069,-85.078125),new google.maps.LatLng(46.498392,-84.770508),new google.maps.LatLng(46.468133,-84.375),new google.maps.LatLng(46.316584,-83.847656),new google.maps.LatLng(46.195042,-83.847656),new google.maps.LatLng(46.012224,-83.71582),new google.maps.LatLng(45.95115,-84.682617),new google.maps.LatLng(45.79817,-86.572266),new google.maps.LatLng(44.590467,-88.110352),new google.maps.LatLng(45.305803,-86.923828),new google.maps.LatLng(44.150681,-87.670898),new google.maps.LatLng(43.100983,-87.890625),new google.maps.LatLng(42.195969,-87.758789),new google.maps.LatLng(41.705729,-87.407227),new google.maps.LatLng(42.000325,-86.748047),new google.maps.LatLng(42.875964,-86.220703),new google.maps.LatLng(43.739352,-86.52832),new google.maps.LatLng(44.653024,-86.264648),new google.maps.LatLng(45.213004,-85.561523),new google.maps.LatLng(45.02695,-85.341797),new google.maps.LatLng(45.243953,-85.297852),new google.maps.LatLng(45.73686,-84.946289),new google.maps.LatLng(45.58329,-84.111328),new google.maps.LatLng(45.089036,-83.408203),new google.maps.LatLng(44.527843,-83.364258),new google.maps.LatLng(43.802819,-84.023438),new google.maps.LatLng(43.675818,-83.62793),new google.maps.LatLng(43.92955,-83.100586),new google.maps.LatLng(43.834527,-82.792969),new google.maps.LatLng(43.2932,-82.573242),new google.maps.LatLng(43.100983,-82.485352),new google.maps.LatLng(42.455888,-83.012695),new google.maps.LatLng(41.869561,-83.364258),new google.maps.LatLng(41.705729,-84.023438),new google.maps.LatLng(40.780541,-84.199219),new google.maps.LatLng(40.580585,-84.726563),new google.maps.LatLng(39.095963,-84.638672),new google.maps.LatLng(38.754083,-83.232422),new google.maps.LatLng(38.410558,-82.441406),new google.maps.LatLng(37.788081,-82.089844),new google.maps.LatLng(36.738884,-83.320313),new google.maps.LatLng(36.668419,-94.482422),new google.maps.LatLng(37.020098,-94.658203),new google.maps.LatLng(37.020098,-108.984375),new google.maps.LatLng(41.310824,-109.248047),new google.maps.LatLng(41.376809,-111.005859),new google.maps.LatLng(45.02695,-110.917969),new google.maps.LatLng(45.02695,-104.414063),new google.maps.LatLng(44.964798,-104.238281)],c=[new google.maps.LatLng(36.949892,-109.072266),new google.maps.LatLng(31.391158,-109.02832),new google.maps.LatLng(31.353637,-108.193359),new google.maps.LatLng(31.765537,-108.237305),new google.maps.LatLng(31.728167,-106.435547),new google.maps.LatLng(31.128199,-105.644531),new google.maps.LatLng(30.221102,-104.72168),new google.maps.LatLng(29.764377,-104.589844),new google.maps.LatLng(29.305561,-103.886719),new google.maps.LatLng(29.036961,-103.359375),new google.maps.LatLng(28.998532,-103.095703),new google.maps.LatLng(29.42046,-102.875977),new google.maps.LatLng(29.802518,-102.392578),new google.maps.LatLng(29.764377,-101.865234),new google.maps.LatLng(29.42046,-101.25),new google.maps.LatLng(29.036961,-100.722656),new google.maps.LatLng(28.149503,-100.151367),new google.maps.LatLng(27.293689,-99.536133),new google.maps.LatLng(26.431228,-98.833008),new google.maps.LatLng(26.115986,-98.217773),new google.maps.LatLng(25.99755,-97.734375),new google.maps.LatLng(25.878994,-97.338867),new google.maps.LatLng(25.878994,-97.163086),new google.maps.LatLng(26.39187,-97.294922),new google.maps.LatLng(27.059126,-97.426758),new google.maps.LatLng(27.955591,-96.987305),new google.maps.LatLng(28.420391,-96.28418),new google.maps.LatLng(29.036961,-95.317383),new google.maps.LatLng(29.458731,-94.87793),new google.maps.LatLng(29.573457,-94.482422),new google.maps.LatLng(29.764377,-93.735352),new google.maps.LatLng(29.688053,-92.8125),new google.maps.LatLng(29.53523,-91.889648),new google.maps.LatLng(29.496988,-91.318359),new google.maps.LatLng(29.267233,-90.307617),new google.maps.LatLng(29.688053,-89.736328),new google.maps.LatLng(29.916852,-89.868164),new google.maps.LatLng(30.259067,-89.077148),new google.maps.LatLng(30.297018,-88.198242),new google.maps.LatLng(30.334954,-87.275391),new google.maps.LatLng(30.372875,-86.44043),new google.maps.LatLng(30.145127,-85.737305),new google.maps.LatLng(29.61167,-85.253906),new google.maps.LatLng(29.802518,-84.682617),new google.maps.LatLng(30.107118,-84.023438),new google.maps.LatLng(29.190533,-83.056641),new google.maps.LatLng(28.921631,-82.749023),new google.maps.LatLng(27.839076,-82.880859),new google.maps.LatLng(27.332735,-82.617188),new google.maps.LatLng(26.352498,-81.826172),new google.maps.LatLng(25.324167,-81.079102),new google.maps.LatLng(25.204941,-80.639648),new google.maps.LatLng(25.958045,-80.112305),new google.maps.LatLng(27.019984,-80.024414),new google.maps.LatLng(27.683528,-80.375977),new google.maps.LatLng(28.690588,-80.727539),new google.maps.LatLng(30.600094,-81.430664),new google.maps.LatLng(31.240985,-81.342773),new google.maps.LatLng(32.063956,-81.079102),new google.maps.LatLng(33.687782,-82.30957),new google.maps.LatLng(34.994004,-83.320313),new google.maps.LatLng(35.065973,-84.375),new google.maps.LatLng(35.639441,-83.496094),new google.maps.LatLng(36.137875,-82.353516),new google.maps.LatLng(36.844461,-81.298828),new google.maps.LatLng(37.370157,-81.298828),new google.maps.LatLng(37.614231,-82.177734),new google.maps.LatLng(36.668419,-83.540039),new google.maps.LatLng(36.633162,-94.482422),new google.maps.LatLng(37.09024,-94.614258),new google.maps.LatLng(36.949892,-108.984375)],d=[new google.maps.LatLng(37.68382,-82.089844),new google.maps.LatLng(38.444985,-82.375488),new google.maps.LatLng(38.822591,-83.210449),new google.maps.LatLng(39.147103,-84.594727),new google.maps.LatLng(40.580585,-84.682617),new google.maps.LatLng(40.797177,-84.155273),new google.maps.LatLng(41.656497,-84.001465),new google.maps.LatLng(41.820455,-83.430176),new google.maps.LatLng(41.52503,-82.902832),new google.maps.LatLng(41.376809,-82.353516),new google.maps.LatLng(41.508577,-81.89209),new google.maps.LatLng(41.902277,-80.90332),new google.maps.LatLng(42.504503,-79.321289),new google.maps.LatLng(42.90816,-79.013672),new google.maps.LatLng(43.261206,-79.101563),new google.maps.LatLng(43.389082,-78.398438),new google.maps.LatLng(43.325178,-77.607422),new google.maps.LatLng(43.357138,-76.948242),new google.maps.LatLng(43.612217,-76.245117),new google.maps.LatLng(44.150681,-76.420898),new google.maps.LatLng(44.933696,-75.19043),new google.maps.LatLng(45.089036,-74.926758),new google.maps.LatLng(45.02695,-74.399414),new google.maps.LatLng(45.02695,-73.432617),new google.maps.LatLng(45.058001,-72.861328),new google.maps.LatLng(45.089036,-71.71875),new google.maps.LatLng(45.367584,-71.015625),new google.maps.LatLng(45.859412,-70.488281),new google.maps.LatLng(46.377254,-70.136719),new google.maps.LatLng(47.129951,-69.609375),new google.maps.LatLng(47.487513,-69.213867),new google.maps.LatLng(47.279229,-68.950195),new google.maps.LatLng(47.279229,-68.598633),new google.maps.LatLng(47.279229,-68.203125),new google.maps.LatLng(47.100045,-67.851563),new google.maps.LatLng(46.407564,-67.807617),new google.maps.LatLng(45.675482,-67.763672),new google.maps.LatLng(45.614037,-67.543945),new google.maps.LatLng(45.305803,-67.412109),new google.maps.LatLng(45.120053,-67.060547),new google.maps.LatLng(44.809122,-66.928711),new google.maps.LatLng(44.496505,-67.851563),new google.maps.LatLng(43.739352,-69.873047),new google.maps.LatLng(43.068888,-70.751953),new google.maps.LatLng(42.391009,-70.927734),new google.maps.LatLng(41.804078,-70.488281),new google.maps.LatLng(41.804078,-70.048828),new google.maps.LatLng(41.409776,-70.048828),new google.maps.LatLng(41.47566,-70.576172),new google.maps.LatLng(41.442726,-71.674805),new google.maps.LatLng(41.277806,-72.905273),new google.maps.LatLng(41.062786,-73.586426),new google.maps.LatLng(40.963308,-73.696289),new google.maps.LatLng(40.913513,-73.146973),new google.maps.LatLng(40.963308,-72.685547),new google.maps.LatLng(41.162114,-72.37793),new google.maps.LatLng(41.046217,-71.872559),new google.maps.LatLng(40.86368,-72.180176),new google.maps.LatLng(40.730608,-73.168945),new google.maps.LatLng(40.63063,-73.674316),new google.maps.LatLng(40.497092,-74.157715),new google.maps.LatLng(40.329796,-73.916016),new google.maps.LatLng(39.842286,-74.157715),new google.maps.LatLng(39.402244,-74.443359),new google.maps.LatLng(38.959409,-74.904785),new google.maps.LatLng(39.164141,-75.014648),new google.maps.LatLng(39.334297,-75.366211),new google.maps.LatLng(39.487085,-75.629883),new google.maps.LatLng(39.113014,-75.410156),new google.maps.LatLng(38.565348,-75.080566),new google.maps.LatLng(38.22092,-75.256348),new google.maps.LatLng(37.649034,-75.695801),new google.maps.LatLng(37.195331,-75.981445),new google.maps.LatLng(37.387617,-76.003418),new google.maps.LatLng(37.892196,-75.783691),new google.maps.LatLng(38.462192,-76.201172),new google.maps.LatLng(39.164141,-76.223145),new google.maps.LatLng(39.35129,-76.376953),new google.maps.LatLng(38.891033,-76.530762),new google.maps.LatLng(38.32442,-76.420898),new google.maps.LatLng(38.065392,-76.398926),new google.maps.LatLng(37.439974,-76.486816),new google.maps.LatLng(37.002553,-76.245117),new google.maps.LatLng(36.297418,-75.849609),new google.maps.LatLng(35.317366,-75.432129),new google.maps.LatLng(34.705493,-76.508789),new google.maps.LatLng(34.615127,-77.102051),new google.maps.LatLng(34.052659,-77.937012),new google.maps.LatLng(33.211116,-79.189453),new google.maps.LatLng(32.49123,-80.332031),new google.maps.LatLng(31.933517,-81.035156),new google.maps.LatLng(35.012002,-83.254395),new google.maps.LatLng(35.119909,-84.221191),new google.maps.LatLng(36.809285,-81.298828),new google.maps.LatLng(37.387617,-81.254883),new google.maps.LatLng(37.649034,-82.089844)],e=[new google.maps.LatLng(69.718107,-141.064453),new google.maps.LatLng(69.718107,-141.591797),new google.maps.LatLng(69.869892,-142.294922),new google.maps.LatLng(70.050596,-142.734375),new google.maps.LatLng(70.140364,-143.349609),new google.maps.LatLng(70.110485,-144.140625),new google.maps.LatLng(69.990535,-144.931641),new google.maps.LatLng(70.080562,-145.722656),new google.maps.LatLng(70.170201,-146.425781),new google.maps.LatLng(70.229744,-147.480469),new google.maps.LatLng(70.466207,-148.974609),new google.maps.LatLng(70.524897,-149.941406),new google.maps.LatLng(70.407348,-150.556641),new google.maps.LatLng(70.436799,-151.171875),new google.maps.LatLng(70.699951,-152.402344),new google.maps.LatLng(70.873491,-152.929688),new google.maps.LatLng(70.959697,-154.599609),new google.maps.LatLng(71.130988,-155.302734),new google.maps.LatLng(71.300793,-156.621094),new google.maps.LatLng(71.102543,-157.324219),new google.maps.LatLng(70.844673,-158.115234),new google.maps.LatLng(70.815812,-159.521484),new google.maps.LatLng(70.495574,-160.488281),new google.maps.LatLng(70.259452,-162.070313),new google.maps.LatLng(69.9303,-162.597656),new google.maps.LatLng(69.411242,-163.300781),new google.maps.LatLng(69.037142,-163.916016),new google.maps.LatLng(68.911005,-164.707031),new google.maps.LatLng(68.879358,-166.113281),new google.maps.LatLng(68.720441,-166.289063),new google.maps.LatLng(68.39918,-166.552734),new google.maps.LatLng(68.301905,-166.289063),new google.maps.LatLng(68.040461,-165.585938),new google.maps.LatLng(67.742759,-164.707031),new google.maps.LatLng(67.441229,-164.091797),new google.maps.LatLng(67.135829,-163.652344),new google.maps.LatLng(66.998844,-162.861328),new google.maps.LatLng(66.964476,-161.982422),new google.maps.LatLng(66.861082,-162.685547),new google.maps.LatLng(66.583217,-161.894531),new google.maps.LatLng(66.266856,-161.542969),new google.maps.LatLng(66.160511,-161.894531),new google.maps.LatLng(66.053716,-163.125),new google.maps.LatLng(66.196009,-164.003906),new google.maps.LatLng(66.583217,-163.916016),new google.maps.LatLng(65.658275,-168.222656),new google.maps.LatLng(65.293468,-166.816406),new google.maps.LatLng(64.997939,-166.816406),new google.maps.LatLng(64.736641,-166.289063),new google.maps.LatLng(64.396938,-165.673828),new google.maps.LatLng(64.586185,-163.828125),new google.maps.LatLng(64.736641,-161.542969),new google.maps.LatLng(64.736641,-161.015625),new google.maps.LatLng(64.434892,-161.279297),new google.maps.LatLng(64.168107,-161.455078),new google.maps.LatLng(64.014496,-161.103516),new google.maps.LatLng(63.587675,-161.279297),new google.maps.LatLng(63.587675,-162.421875),new google.maps.LatLng(63.074866,-163.564453),new google.maps.LatLng(63.352129,-164.003906),new google.maps.LatLng(63.154355,-164.619141),new google.maps.LatLng(62.674143,-165.146484),new google.maps.LatLng(62.308794,-165.410156),new google.maps.LatLng(61.897578,-166.025391),new google.maps.LatLng(61.396719,-166.113281),new google.maps.LatLng(61.100789,-165.673828),new google.maps.LatLng(60.152442,-167.519531),new google.maps.LatLng(59.667741,-166.201172),new google.maps.LatLng(60.152442,-164.882813),new google.maps.LatLng(59.800634,-163.828125),new google.maps.LatLng(59.933,-162.333984),new google.maps.LatLng(59.445075,-161.894531),new google.maps.LatLng(58.722599,-161.982422),new google.maps.LatLng(58.447733,-161.542969),new google.maps.LatLng(58.904646,-160.488281),new google.maps.LatLng(58.722599,-159.521484),new google.maps.LatLng(58.35563,-158.90625),new google.maps.LatLng(58.950008,-158.642578),new google.maps.LatLng(58.631217,-158.378906),new google.maps.LatLng(58.859224,-157.236328),new google.maps.LatLng(58.447733,-157.763672),new google.maps.LatLng(57.704147,-157.763672),new google.maps.LatLng(56.704506,-159.609375),new google.maps.LatLng(56.072035,-161.455078),new google.maps.LatLng(53.696706,-168.310547),new google.maps.LatLng(52.321911,-175.166016),new google.maps.LatLng(51.781436,-178.154297),new google.maps.LatLng(52.268157,176.748047),new google.maps.LatLng(53.120405,172.265625),new google.maps.LatLng(52.696361,172.001953),new google.maps.LatLng(52.160455,173.583984),new google.maps.LatLng(50.958427,-180),new google.maps.LatLng(51.890054,-174.023438),new google.maps.LatLng(54.265224,-163.652344),new google.maps.LatLng(56.656226,-153.808594),new google.maps.LatLng(57.797944,-151.787109),new google.maps.LatLng(58.493694,-152.314453),new google.maps.LatLng(59.040555,-153.808594),new google.maps.LatLng(59.756395,-153.105469),new google.maps.LatLng(60.973107,-151.435547),new google.maps.LatLng(61.227957,-150.205078),new google.maps.LatLng(60.973107,-149.765625),new google.maps.LatLng(60.973107,-150.732422),new google.maps.LatLng(60.326948,-151.523438),new google.maps.LatLng(59.756395,-151.875),new google.maps.LatLng(59.310768,-152.138672),new google.maps.LatLng(59.130863,-151.611328),new google.maps.LatLng(59.623325,-150.380859),new google.maps.LatLng(59.977005,-149.326172),new google.maps.LatLng(59.933,-148.271484),new google.maps.LatLng(59.800634,-147.65625),new google.maps.LatLng(60.152442,-146.601563),new google.maps.LatLng(60.370429,-145.371094),new google.maps.LatLng(60.06484,-143.964844),new google.maps.LatLng(59.933,-141.503906),new google.maps.LatLng(59.667741,-140.712891),new google.maps.LatLng(59.888937,-139.746094),new google.maps.LatLng(58.7682,-138.164063),new google.maps.LatLng(58.077876,-136.933594),new google.maps.LatLng(56.704506,-135.527344),new google.maps.LatLng(55.72711,-134.472656),new google.maps.LatLng(54.110943,-133.59375),new google.maps.LatLng(52.05249,-131.572266),new google.maps.LatLng(52.160455,-130.869141),new google.maps.LatLng(54.673831,-130.957031),new google.maps.LatLng(55.279115,-130.253906),new google.maps.LatLng(56.12106,-130.078125),new google.maps.LatLng(56.752723,-131.660156),new google.maps.LatLng(59.489726,-135.175781),new google.maps.LatLng(59.800634,-135.703125),new google.maps.LatLng(59.265881,-136.669922),new google.maps.LatLng(59.085739,-137.548828),new google.maps.LatLng(60.326948,-139.21875),new google.maps.LatLng(60.370429,-140.976563),new google.maps.LatLng(69.62651,-141.152344)],f=.5,g=.8,h=new google.maps.Polygon({geodesic:!1,paths:a,strokeColor:"#8c510a",strokeOpacity:g,strokeWeight:2,fillColor:"#8c510a",fillOpacity:f}),i=new google.maps.Polygon({geodesic:!1,paths:b,strokeColor:"#d8b365",strokeOpacity:g,strokeWeight:2,fillColor:"#d8b365",fillOpacity:f}),j=new google.maps.Polygon({geodesic:!1,paths:c,strokeColor:"#003c30",strokeOpacity:g,strokeWeight:2,fillColor:"#003c30",fillOpacity:f}),k=new google.maps.Polygon({geodesic:!1,paths:d,strokeColor:"#5ab4ac",strokeOpacity:g,strokeWeight:2,fillColor:"#5ab4ac",fillOpacity:f}),l=new google.maps.Polygon({geodesic:!1,paths:e,strokeColor:"#543005",strokeOpacity:g,strokeWeight:2,fillColor:"#543005",fillOpacity:f}),m=new google.maps.Circle({center:new google.maps.LatLng(22.065278,-159.587402),fillColor:"rgb(29, 121, 161)",fillOpacity:f,strokeColor:"rgb(29, 121, 161)",strokeOpacity:g,strokeWeight:2});m.setRadius(73848.25);var n=new google.maps.Circle({center:new google.maps.LatLng(21.493964,-157.983398),fillColor:"rgb(29, 121, 161)",fillOpacity:f,strokeColor:"rgb(29, 121, 161)",strokeOpacity:g,strokeWeight:2});n.setRadius(64538.2);var o=new google.maps.Circle({center:new google.maps.LatLng(20.509355,-156.09375),fillColor:"rgb(29, 121, 161)",fillOpacity:f,strokeColor:"rgb(29, 121, 161)",strokeOpacity:g,strokeWeight:2});o.setRadius(169887);var p=new google.maps.Circle({center:new google.maps.LatLng(-14.317615,-170.771484),fillColor:"rgb(29, 121, 161)",fillOpacity:f,strokeColor:"rgb(29, 121, 161)",strokeOpacity:g,strokeWeight:2});return p.setRadius(25426),regions={Pacific:h,Alaska:l,Central:i,Southern:j,Eastern:k,"Pacific Islands":[m,n,o,p]},objectforeach(regions,function(a,b){setRegionHandlers(a,b)}),regions}function setRegionHandlers(a,b,c){var d="cyan";return a.properties={name:b},a.forEach instanceof Function&&a[0]?a.forEach(function(c){setRegionHandlers(c,b,a)}):(google.maps.event.addListener(a,"click",function(){unhighlightRegion.call(this),unhighlightStation.call(this),this.fillcolor=getRegionColor(b),app.highlightedRegion=this,this.setOptions({strokeColor:d,zIndex:999}),regionInfoWindowFunction(a,b,c)}),a)}function regionInfoWindowFunction(a,b,c){return openInfoWindow(a,a,function(d){var e=d.split(";"),f="";e.forEach(function(a){var c=a.split(":");f+=c.length>1?'<p><span class="attrKey">'+c[0]+'</span><span class="attrVal">'+c[1]+"</span></p>":"<p>"+a+(a===b?" Region":"")+"</p>"});var g=$("<div>Hide stations not in this region</div>").on("click",filterStations.bind(a,b)).addClass("popup-button"),h=$("<div>Zoom to "+b+" region</div>").on("click",zoomToLayer.bind(c||a,c||a)).addClass("popup-button");return f=$(f).append(g).append(h)})}function matchRegion(a){return{Western:"Western",Alaska:"Alaska",Central:"Central",Southern:"Southern",Eastern:"Eastern",Pacific:"Pacific Islands"}[a]}function matchRegionAbbrev(a){return{SR:"Southern",CR:"Central",ER:"Eastern",WR:"Western",AR:"Alaska",PR:"Pacific"}[a]}function matchRegionNameToRegion(a){return{Southern:"Southern",Central:"Central",Eastern:"Eastern",Western:"Western",Alaska:"Alaska",Pacific:"Pacific","Pacific Islands":"Pacific"}[a]}function filterStations(a){window.regionname=a;var b,a=matchRegionNameToRegion(a);window.region=b,objectforeach(app.layers.Sites.sublayers,function(b){var c;b.forEach(function(d){var e=matchRegionAbbrev(d.getProperty("nws_region"));return e?(a===e?(c=!0,b.overrideStyle(d,{visible:!0}),d.__proto__.isHidden=!1):b.overrideStyle(d,{visible:!1}),void(d.__proto__.isHidden=!0)):(b.overrideStyle(d,{visible:!1}),void(d.__proto__.isHidden=!0))}),c?b.getMap&&!b.getMap()&&(b.setMap(app.map),b.getCheckbox instanceof Function&&(b.getCheckbox()[0].checked=!0)):(b.setMap&&b.setMap(null),b.getCheckbox instanceof Function&&(b.getCheckbox()[0].checked=!1))})}function unhighlightRegion(){app.highlightedRegion&&app.highlightedRegion!==this&&app.highlightedRegion.setOptions({strokeColor:app.highlightedRegion.fillcolor,zIndex:10})}function unhighlightStation(){app.highlighted&&app.hovered!==this&&app.highlighted.setIcon(stationicon)}function styleStations(a){var b=a.properties;!b&&a.forEachProperty instanceof Function&&(b={},a.forEachProperty(function(a,c){b[c]=a}));var c=b.mission||b.site_mission,d=b.complex_id,e=(matchRegionAbbrev(b.mws_region),getStationIcon(c));return d&&(b.url='<a class="station-link popup-button" href="http://cascade-eam.com/map/complex.php?complexid='+d+'" target="_blank">Go to station report</a>'),b.image_url&&-1===b.image_url.indexOf("<img")&&(b.image_url='<img class="popup-image" src="images/'+b.image_url+'"/>'),b.nexrad="NEXRAD"===c?"NEXRAD":"NO",b.uaib="UAIB"===c?"UAIB":"NO",a.setProperty instanceof Function&&(a.setProperty("nexrad",b.nexrad),a.setProperty("uaib",b.uaib),a.setProperty("url",b.url),a.setProperty("image_url",b.image_url)),e}function getStationIcon(a){var b;switch(a){case"WFO":b="wfo.png";break;case"WSO":b="wso.png";break;case"WFO/RFC":b="wforfc.png";break;case"DCO":b="dco.png";break;case"NWS HOUSING":b="nwshousing.png";break;case"NATIONAL CENTER":b="nationalcenter.png";break;case"REGIONAL HQ":b="regionalhq.png";break;case"SPECIAL MISSION":b="specialmission.png";break;case"UAIB":b="uaib.png";break;case"NEXRAD":b="nexrad.png";break;
default:b="wfo.png"}return"http://cascade-eam.com/map/mapicons/"+b}function init(){initialCenter=new google.maps.LatLng(49.40239,-122.91548);var a={zoom:initialZoom,center:initialCenter,mapTypeId:google.maps.MapTypeId.ROADMAP},b=app.map=new google.maps.Map(document.getElementById("map"),a);b.enableKeyDragZoom(),google.maps.event.addListener(app.map,"tilesloaded",hideLoading),google.maps.event.addListener(app.map,"bounds_changed",showLoading),google.maps.event.addListener(app.map,"bounds_changed",checkHideLoading),placesService=new google.maps.places.PlacesService(document.createElement("div")),addResizeHandler().initSearch().enableDrawing(b).addLayers(),app.regions=addRegions(b),initialBounds=b.getBounds(),hideLoading()}function getRegionColor(a){return{Western:"#8c510a",Alaska:"#543005",Central:"#d8b365",Southern:"#003c30",Eastern:"#5ab4ac",Pacific:"rgb(29, 121, 161)","Pacific Islands":"rgb(29, 121, 161)"}[a]}function addRegionLegends(a){var b={subtypes:[],sublayers:{},map:app.map,setMap:function(c){return objectforeach(a,function(a,d){var e=b.sublayers[d],f=e.getCheckbox();a instanceof Array?a.forEach(function(a){a.setMap(c),f[0].checked=!!c}):(a.setMap(c),f[0].checked=!!c),!f[0].checked&&c&&f.trigger("click"),c||(f[0].checked=!1)}),this},getMap:function(){return app.stationsCluster.getMap()}},c={name:"Regions",layer:b,nolegend:!0,expanded:!0,makeIcon:function(a){return createLegendSwatch(getRegionColor(a.name))},setMap:function(a){b.setMap(a)},layerVisible:!0,subtypes:[]};objectforeach(a,function(a,c){var d={name:c,layer:a,map:app.map,setMap:function(b){a instanceof Array?a.forEach(function(){a.setMap(b)}):a.setMap(b)},layerVisible:!0,setOpacity:function(b){a instanceof Array?station.forEach(function(a){a.setOpacity(b)}):a.setOpacity(b)},subtypeFunction:function(){var c=this.checked;a instanceof Array?a.forEach(function(a){a.setMap(c?app.map:null)}):a.setMap(c?app.map:null);var d=b.getCheckbox();c&&!d[0].checked&&(d[0].checked=!0,objectforeach(a,function(a,c){var d=b.sublayers[c];if(console.log(d,a,c),d){var e=d.getCheckbox();e[0].checked&&a.forEach(function(a){-1===app.stationsCluster.getMarkers().indexOf(a)&&a.setMap(app.map)})}}))}};b.subtypes.push(c),b.sublayers[c]=d}),addToLegend(c)}function addStationLegends(a){var b={subtypes:[],sublayers:{},icon:"images/5ccffdcf.noaa32x32.png",map:app.map,setMap:function(c){return objectforeach(a,function(a,d){var e=b.sublayers[d],f=e.getCheckbox();a.forEach(function(a){c?f[0].checked&&-1===app.stationsCluster.getMarkers().indexOf(a)&&(a.setMap(app.map),app.stationsCluster.addMarker(a)):-1!==app.stationsCluster.getMarkers().indexOf(a)&&(a.setMap(null),app.stationsCluster.removeMarker(a),f[0].checked=!1),!f[0].checked&&c&&f.trigger("click"),c||(f[0].checked=!1)})}),app.stationsCluster.setMap(c),this},getMap:function(){return app.stationsCluster.getMap()}},c={name:"Station Mission",layer:b,nolegend:!0,expanded:!0,setMap:function(a){console.log(a),app.stationsCluster.setMap(a)},layerVisible:!0,subtypes:[]};objectforeach(a,function(c,d){var e={name:d,layer:c,map:app.map,setMap:function(a){console.log(a),app.stationsCluster.setMap(a)},layerVisible:!0,setOpacity:function(a){c.forEach(function(b){b.setOpacity(a)})},subtypeFunction:function(){var d=this.checked;c.forEach(function(a){d?-1===app.stationsCluster.getMarkers().indexOf(a)&&(a.setMap(app.map),app.stationsCluster.addMarker(a)):-1!==app.stationsCluster.getMarkers().indexOf(a)&&(a.setMap(null),app.stationsCluster.removeMarker(a))});var e=b.getCheckbox();d&&!e[0].checked&&(app.stationsCluster.setMap(app.map),e[0].checked=!0,objectforeach(a,function(a,c){var d=b.sublayers[c],e=d.getCheckbox();e[0].checked&&a.forEach(function(a){-1===app.stationsCluster.getMarkers().indexOf(a)&&(a.setMap(app.map),app.stationsCluster.addMarker(a))})}))}};b.subtypes.push(d),b.sublayers[d]=e}),addToLegend(c)}function toggleLayer(a){{var b=a.data.layer;a.data.legendinfo.parentcheck,a.data.legendinfo.parent}if(showLoading("<span>loading"+name+"</span>",1),b.getMap&&!b.getMap())b.setMap(app.map),b.overrideStyle&&b.overrideStyle({visible:!0}),b.forEach&&b.forEach(function(a){a.__proto__.isHidden=!1,b.overrideStyle&&b.overrideStyle(a,{visible:!0})});else if(b.setMap){b.setMap(null);var c=b.loaded?b.loaded.popup:b.popup;c&&switchLeftPaneContent({showitem:$("#TOC"),name:"TOC"})}hideLoading()}function createLegendSwatch(a,b){var c=$("<span></span>").addClass("legendSwatch").css({"background-color":a,opacity:.65,display:a?"inline-block":"none"});return b&&(c=$("<img/>")),c}function addLegendItem(a,b,c){var d=b.name,e=$('<input type="checkbox"/>').addClass("legendItem").addClass(d).on("change",{layer:a,legendinfo:b},b.toggleLayer?b.toggleLayer:toggleLayer).on("click",function(a){a.ctrlKey&&$(this).parent().find("ul").find("input[type=checkbox]"+(this.checked?"":":checked")).trigger("click")}).on("contextmenu",function(a){a.preventDefault(),$(this).trigger("click"),$(this).parent().find("ul").find("input[type=checkbox]"+(this.checked?"":":checked")).trigger("click")}),f=$("<img/>").attr("src","images/c1ef1820.search.png").addClass("zoomToLayer").on("click",function(){a.setMap(app.map);var b=c||a;zoomToLayer(b.layer||b),showLoading("<span>zooming to "+d+"</span>")});c?(c.checkbox=e,c.getCheckbox=function(){return e}):(a.checkbox=e,a.getCheckbox=function(){return e});var g,h=$("<span></span>").html(b.name).addClass("legendLabel").on("click",function(a){e.trigger("click"),a.ctrlKey&&$(this).parent().find("ul").find("input[type=checkbox]"+(e[0].checked?"":":checked")).trigger("click")}).on("contextmenu",function(a){a.preventDefault(),e.trigger("click"),$(this).parent().find("ul").find("input[type=checkbox]"+(e[0].checked?"":":checked")).trigger("click")}),i=$("<li></li>").append(b.makeIcon?b.makeIcon(b):null).append(e).append(h).append(f);b.nolegend||(g=$("<span></span>").html(b.buttonText||(b.expanded?"&#9650;":"&#9660;")).addClass("individual legendItemToggle "+(b.expanded?"":"collapsed")));var j=$("<div></div>").addClass("legendItemContainer").css("cursor","pointer").on("click",function(){l&&l.stop().slideToggle(),b.subtext&&n.stop().fadeToggle(),m&&$(m).stop().slideToggle(),!b.nolegend&&g&&g.html(g.hasClass("collapsed")?"&#9650;":b.buttonText||"&#9660;").toggleClass("collapsed")}).append(g).appendTo(i);if(b.slider){a.slider=$("<div></div>").slider({min:0,max:1,value:.75,step:.05,animate:"fast",slide:function(b,c){a.loaded?a.loaded.setOpacity(c.value):a.setOpacity(c.value)}}).addClass(a.getMap()?"":"hidden").prependTo(j)}if(b.icon){var k=b.icon;if("string"==typeof k&&(-1!=k.indexOf("http")||-1!=k.indexOf(".png")||-1!=k.indexOf(".jpg")||-1!=k.indexOf(".svg")))var l=$("<img/>").attr("src",k).css({display:"block"}).hide().appendTo(j);if("function"==typeof b.icon){var m=k(b);m&&$(m).appendTo(j)}}if(b.subtext)var n=$("<span></span>").html(b.subtext).hide().css({"font-size":"12px"}).appendTo(i);return e[0].checked=b.layerVisible,i}function toggleLegendGroup(){var a=$(this).parent().find("input[type=checkbox]");$.each(a,function(){toggleSublayer.call(this,null,null,$(this).parent())})}function addLegendGroup(a){{var b;$("<li></li>").append(d).append(e)}if(a.legendGroupClass&&(b=$("#TOC ."+a.legendGroupClass+" ul")),!b||b.length<1){var c=a.name,d=a.parentcheck=$('<input type="checkbox"/>').addClass("legendItem").addClass("group").css("box-shadow",getUtilityColor(c)+" 2px 2px 0px").on("change",toggleLegendGroup),e=$("<span></span>").html(a.legendGroupTitle).addClass("legendLabel").on("click",function(){d.trigger("click")});return b=$("<li></li>").addClass(a.legendGroupClass).append(d).append(e).appendTo("#TOC"),a.parent=$("<ul></ul>").addClass(a.expanded?"":"collapsed").appendTo(b),a.parent}return a.parent=b,a.parentcheck=b.parent().find("input[type=checkbox]").first(),b}function collapseGroup(a,b){a.html(a.hasClass("collapsed")?"&#9650;":"&#9660;").toggleClass("collapsed");var c=b.hasClass("collapsed");return b.removeClass("collapsed"),c?b.hide().stop().slideDown():b.stop().slideToggle()}function addToLegend(a){var b,c=a.layer,d=$("#legend #TOC");if(a.legendGroupClass){b=addLegendGroup(a);var e=b.parent();e.data("sublayers",e.data("sublayers")&&e.data("sublayers").length>0?e.data("sublayers"):[]),e.data("sublayers").push(c),a.toggleLayer=function(a){toggleSublayer.call(a.target,c,c,e),console.log(a.target,c,c,e),hideLoading()},item=addLegendItem(c,a).appendTo(b),b.parent().find(".collapser").length<1&&$("<div></div>").html("&#9660;").addClass("collapser").addClass(a.expanded?"":"collapsed").off("click").on("click",function(){collapseGroup($(this),b)}).prependTo(b.parent())}else b=addLegendItem(c,a);if(d.has(b).length<1&&d.append(b),c.subtypes){var f=$("<ul></ul>").addClass(a.expanded?"":"collapsed"),g=b.find("div").first().html("&#9660;").addClass("collapser "+(a.expanded?"":"collapsed")).off("click").on("click",function(){collapseGroup(g,f)});b.append(g).append(f),c.subtypes.forEach(function(d){var e=$.extend({},a),g=c.sublayers[d];e.name=d,e.toggleLayer=function(a){g.subtypeFunction.call(a.target,c,c.sublayers[d],b),hideLoading()};addLegendItem(c,e,c.sublayers[d]).appendTo(f)}),f.parent().find(".zoomToLayer").first().remove()}}function checkHideLoading(){for(key in app.loaded){var a=app.loaded[key];if(!a[0]&&a[1])return!1}hideLoading()}function clearSelection(){selectedShape&&(selectedShape.setEditable(!1),selectedShape=null)}function setSelection(a){clearSelection(),selectedShape=a,a.setEditable(!0)}function addLayer(a,b,c,d){app.layers=app.layers||{};var e=app.layers[a]=b,f=app.loaded||{},g=e.afterload=[];return b.name=a,e.getMap=function(){return e.loaded?e.loaded.getMap():b.map},g.push(function(b){google.maps.event.addListener(b,"status_changed",function(c){f[a][0]=!0,checkHideLoading(b,c)})}),"function"==typeof d?g.push(function(a){return google.maps.event.addListener(a,"click",d.bind(a)),a}):d instanceof Array&&d.forEach(function(a){"function"==typeof a&&g.push(function(b){return google.maps.event.addListener(b,"click",a.bind(b)),b})}),e.setMap=function(c){var d,g=e.afterload;return e.loaded?(e.loaded.slider&&e.loaded.slider.toggleClass("hidden"),e.slider&&e.slider.toggleClass("hidden"),e.loaded.setMap(c),e):void(c&&(f[a]=[!1,b.map],d=e.loaded=b(),d.setMap(c),g&&g.forEach(function(a){a.call(d,d)})))},e.setOpacity=function(a){e.loaded&&e.loaded.setOpacity(a)},c.layer=e,c.name=c.name||a.toTitleCase(),c.layerVisible=e.map,addToLegend(c),b}function closeInfoWindows(){popup&&(popup.close instanceof Function&&popup.close(),popup.layer&&(popup.layer.revertStyle instanceof Function&&popup.layer.revertStyle(),popup.layer.selectedFeatureID&&popup.layer.getFeatureStyle instanceof Function&&popup.layer.getFeatureStyle(popup.layer.selectedFeatureID).resetAll())),switchLeftPaneContent({showitem:$("#TOC"),name:"TOC"})}function handleLayerClick(a,b){if(a.getDetails){var c=b.loaded;c.selectedFeatureID=a.featureId,a.getDetails(function(a){openInfoWindow(a,c)})}a.feature&&b.overrideStyle instanceof Function&&(b.revertStyle(),openInfoWindow.call(this,a.feature,b))}function addLayers(){return addLayerFromJSON({name:"Regions",url:"json/NWS_Regions.json",url:"json/NWS_Regions_topo.json",topojson:"collection",filter:"NAME",stylefunc:getRegionColor,styleProp:"Type",layerapplyfuncs:[setRegionHandlers,function(a){google.maps.event.addListener(app.map,"zoom_changed",function(){var b=app.map.getZoom();b>=7&&(a.setMap(null),a.getCheckbox instanceof Function&&(a.getCheckbox()[0].checked=!1))})}],nodefaultlisteners:!0,map:app.map,nolegend:!0,expanded:!0,makeIcon:function(a){return createLegendSwatch(getRegionColor(a.name))},subtypeFunction:toggleSublayer}),addLayerFromJSON({name:"Sites",filter:"site_mission",url:"json/NWS_Site_Locations_updated.json",nodefaultlisteners:!0,cluster:!0,clusterAll:!0,clusterFilter:"nws_region",icon:function(a){var b=a.name,c=getStationIcon(b);return c?'<img class="legendIcon" src="'+c+'" />':!1},styler:function(a){return{icon:styleStations(a)}},subtypeFunction:toggleSublayer,layerapplyfuncs:[function(a){google.maps.event.addListener(a,"click",function(b){openInfoWindow(b.feature,a)})}],map:app.map,expanded:!0}),addLayerFromJSON({name:"Seismic Zones",url:"json/Lower48_Seismic_Zones_wgs84_topo.json",topojson:"collection",stylefunc:getSeismicZoneColor,styleProp:"Standard_g",styleFeature:!0,styleoptions:{strokeWeight:0,fillOpacity:.7},noPopupZoomTo:!0,icon:function(){return'<div class="seismic-legend"><p class="legendSwatch" style="opacity: 0.65; display: inline-block; background-color: #a50026;"><span>Zone A</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #d73027;"><span>Zone B</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #f46d43;"><span>Zone C</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #fdae61;"><span>Zone D</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #fee08b;"><span>Zone E</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #ffffbf;"><span>Zone F</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #d9ef8b;"><span>Zone G</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #a6d96a;"><span>Zone H</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #66bd63;"><span>Zone I</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #1a9850;"><span>Zone J</span></p>                <p class="legendSwatch"" style="opacity: 0.65; display: inline-block; background-color: #006837;"><span>Zone K</span></p></div>'},nodefaultlisteners:!0,expanded:!0,subtypeFunction:toggleSublayer}),this}function getSeismicZoneColor(a,b){var a=a.trim(),c={"Zone A":"#a50026","Zone B":"#d73027","Zone C":"#f46d43","Zone D":"#fdae61","Zone E":"#fee08b","Zone F":"#ffffbf","Zone G":"#d9ef8b","Zone H":"#a6d96a","Zone I":"#66bd63","Zone J":"#1a9850","Zone K":"#006837"}[a],d=b||{};return d.fillColor=c,d}function addLayerFromJSON(a){var b,c=a.name,d=a.map,e=a.expanded,f=a.url,g=a.nolegend,h=(a.legend,a.filter),i=a.cluster,j=a.clusterAll,k=a.clusterFilter,l=a.icon,m=a.topojson,n=a.style,o=a.stylefunc,p=a.styleProp,q=a.styler,r=a.listeners,s=a.nodefaultlisteners,t=a.layerapplyfuncs,u=a.makeIcon,v=a.styleFeature,w=a.styleoptions,x=a.noPopupZoomTo,y=a.subtypeFunction,z=new XMLHttpRequest;return z.open("GET",f,!0),z.onload=function(){var a=JSON.parse(this.responseText);m&&(a=topojson.feature(a,a.objects[m])),a.features=a.features.filter(function(a){return a.geometry&&a.geometry.type&&a.geometry.coordinates&&a.geometry.coordinates.length>1}),h&&(b={name:c,json:a,map:d,setMap:function(a){return showLoading("<span>loading: "+this.name+"</span>",1),this.map=a,google.maps.event.trigger(b,"setmap",a,b),this.sublayers&&$.each(this.sublayers,function(b,c){a?c.hadMap&&(c.setMap(c.hadMap),c.hadMap=null):(c.getMap()&&(c.hadMap=c.getMap()),c.setMap(a))}),hideLoading(),this},getMap:function(){return this.map}},b.subtypes=[],b.sublayers={},a.features.map(function(a){return a.properties[h].trim()}).forEach(function(a){-1===b.subtypes.indexOf(a)&&b.subtypes.push(a.trim())})),b&&b.subtypes?b.subtypes.forEach(function(c){var e={type:"FeatureCollection",features:[]};a.features.forEach(function(a){a.properties[h].trim()===c.trim()&&e.features.push(a)}),a.features=uniq(a.features);var f=new google.maps.Data;t&&t.forEach(function(a){a(f,c)}),s||addLayerListeners(f,r),q&&q instanceof Function?f.setStyle(q):(o||n)&&styleData({type:c},f,o||n,p,v,w),f.addGeoJson(e),f.json=e,f.noPopupZoomTo=x,f.subtypeFunction=y,i&&(google.maps.event.addListener(app.map,"zoom_changed",function(){app.map.getZoom()>=4&&f.getCheckbox()[0].checked&&f.setMap(app.map)}),google.maps.event.addListener(f,"setmap",function(a){a&&a.getZoom()<4&&(this.hadMap=a,this.setMap(null))}),google.maps.event.addListener(f,"setproperty",function(){var a=this.getMap();a&&a.getZoom()<4&&(this.hadMap=a,this.setMap(null))})),b.sublayers[c]=f,f.name=c,d&&f.setMap(d)}):(b=new google.maps.Data,addLayerListeners(b,r),q&&q instanceof Function?b.setStyle(q):(o||n)&&styleData({type:c},b,o||n,p,v,w),t&&t.forEach(function(a){a(b,c)}),b.addGeoJson(a),b.noPopupZoomTo=x,b.json=a,b.name=c,d&&b.setMap(d)),i&&j&&(b.clusters={},google.maps.event.addListener(b,"setproperty",function(){var a=this.getMap();console.log(b),a&&a.getZoom()<4&&(this.hadMap=a,this.setMap(null))}),k&&(b.json.features.forEach(function(a){if(!a.properties[k])return!1;var c=b.clusters[a.properties[k]];c||(c=b.clusters[a.properties[k]]={}),c.count=c.count?c.count+=1:1,c.bounds=c.bounds||new google.maps.LatLngBounds,c.bounds.extend(new google.maps.LatLng(a.geometry.coordinates[1],a.geometry.coordinates[0]))}),objectforeach(b.clusters,function(a,c){if(!matchRegionAbbrev(c))return!1;var e=a.bounds.getCenter(),f=new Label({map:d,className:"station-group trans "+c,title:"Click to zoom in to "+matchRegionAbbrev(c)+" stations",text:"<b>"+matchRegionAbbrev(c)+"</b>"+a.count+" complexes",position:e});f.bindTo("position",e),f.bindTo("text",e),a.marker=f,a.marker.getMap()&&b.setMap(null),google.maps.event.addDomListener(f.span,"click",function(){app.map.fitBounds(a.bounds)}),google.maps.event.addDomListener(f.span,"mouseover",function(){f.bringToFront()}),google.maps.event.addListener(b,"setmap",function(b){setTimeout(function(){a.marker.addTo(!b&&app.map.getZoom()<4?app.map:null)},10)}),google.maps.event.addListener(app.map,"zoom_changed",function(){var c=app.map.getZoom();window.z=c,window.layer=b,4>c?b.getCheckbox()[0].checked&&(a.marker.addTo(app.map),b.setMap(null)):b.getCheckbox()[0].checked&&(a.marker.addTo(null),b.setMap(app.map))})}))),addToLegend({nolegend:g,name:c,layer:b,subtypeFilter:h,makeIcon:u,expanded:e,icon:l,layerVisible:d}),app.layers=app.layers||{},app.layers[c]=b},z.send(),b}function addLayerListeners(a,b){return b?objectforeach(b,function(b,c){a.addListener(c,function(c){b.call(this,c,a)})}):a.addListener("click",function(b){handleLayerClick(b,a)}),a}function toggleSublayer(a,b,c){var d=b?": "+b.name:"";showLoading("<span>loading"+d+"</span>",1);var e=c.data("sublayers"),f=c.children("input[type=checkbox]").first();if(e)e.forEach(function(c){a||b?b===c&&(c.checkbox[0].checked?(c.setMap(app.map),c.overrideStyle&&c.overrideStyle({visible:!0}),c.forEach&&SL.forEach(function(a){a.__proto__.isHidden=!1,c.overrideStyle&&c.overrideStyle(a,{visible:!0})}),c.hadMap=app.map,f.off("change").prop("checked",!0).on("change",toggleLegendGroup.bind(f[0]))):(c.hadMap=null,c.setMap(null))):(c.loaded||(c.loaded=c()),f[0].checked?c.checkbox[0].checked?(c.setMap(app.map),c.overrideStyle&&c.overrideStyle({visible:!0}),c.forEach&&c.forEach(function(a){a.__proto__.isHidden=!1,c.overrideStyle&&c.overrideStyle(a,{visible:!0})}),c.slider.removeClass("hidden")):c.checkbox.trigger("click"):c.checkbox[0].checked?c.checkbox.trigger("click"):(c.setMap(null),c.slider.addClass("hidden")))});else if(b)return this.checked?(b.hadMap=a.map=app.map,f[0].checked=!0,b.setMap(app.map),b.overrideStyle&&b.overrideStyle({visible:!0}),b.forEach&&b.forEach(function(a){a.__proto__.isHidden=!1,b.overrideStyle&&b.overrideStyle(a,{visible:!0})}),b):(b.hadMap=null,b.setMap(null),b);hideLoading()}function styleData(a,b,c,d,e,f,g){var h=a&&a.feature?a.feature:null,i=a.type||h.getProperty(d||"Type"),j=c instanceof Function?c(i):c,k=c instanceof Function?c(i):c;g&&g.push(i);var l=.5,m=.8;b.setStyle(e?function(a){return c(a.getProperty(d),f)}:{strokeColor:j,fillColor:k,strokeOpacity:m,fillOpacity:l})}function resize(){google.maps.event.trigger(app.map,"resize"),autosize()}function addResizeHandler(){return resize(),$(window).on("resize",resize),($("html").hasClass("ie8")||$("html").hasClass("ie7"))&&addIEresizers(),this}function addIEresizers(){ieResize(),$(window).on("resize",ieResize),$("head").append("<style>.zoomToLayer{ width: 12px; height: 12px;}#TOC > li > ul{margin-left: 10px;} </style>"),$(".legendToggle").off("click").on("click",function(){$(this).toggleClass("split"),$("#legend").hasClass("split")?($("#legend").hide().removeClass("split"),$("#map").width($(window).width()).removeClass("split")):($("#legend").show().addClass("split"),$("#map").width($(window).width()-330-$("#legendToggle").width()-15).addClass("split")),autosize(),google.maps.event.trigger(app.map,"resize")})}function ieResize(){var a=$("#legend").height($(window).height()-$("#banner").height()),b=$("#map").height($(window).height()-$("#banner").height());a.hasClass("split")&&b.width($(window).width()-a.width()-$("#legendToggle").width()-15),autosize(),google.maps.event.trigger(app.map,"resize")}function popupToSideBar(a){return switchLeftPaneContent({showitem:a.show(),name:"Attributes"}),$(".legendToggle").hasClass("split")||$(".legendToggle").trigger("click"),a}function highlightFeature(a,b){if(b.overrideStyle instanceof Function){var c,d=b.getStyle(a);d&&(c=d.strokeWeight?d.strokeWeight+5:6),d&&c&&b.overrideStyle(a,{strokeColor:"cyan",strokeWeight:c})}}function openInfoWindow(a,b,c){closeInfoWindows(),popup&&popup.remove();var d=popup=this.popup=$("<div></div>").addClass("sidebarpopup autosize");if(popup.layer=b,a.infoWindowHtml){console.log(a.infoWindowHtml);var e=$(a.infoWindowHtml),f="<h3>Sorry, this camera isn't active or you don't have access...<br/></h3>";return e.find("a").each(function(){$(this).attr("prev-href",$(this).attr("href")).attr("href","#").attr("target","").one("click",function(a){a.preventDefault(),e.append(f)})}),d.append(e),popupToSideBar(d)}var g=document.createElement("div"),h=$(document.createElement("div"));d.append(h);var i=a.desc;if(i){var j,l=i,m=$("<div></div>"),g=l.title;l.ImageFile&&(j=l.Video?$('<embed type="application/x-mplayer2" pluginspage="http://microsoft.com/windows/mediaplayer" id="mediaPlayer" name="mediaPlayer" displaysize="4" autosize="-1" bgcolor="darkblue" showcontrols="true" showtracker="-1" showdisplay="0" showstatusbar="-1" videoborder3d="-1" width="100%" height="100%" autostart="true" loop="false" >'):document.createElement("img"),j.src=l.ImageFile,j.width=l.Width,j.height=l.Height,m.append(j));for(k in l)-1==["Video","Height","RefreshRate","Width","ImageFile","Enabled","ID","Point","Direction","DisplayType","Category","UpdateTime","StartTime"].indexOf(k)&&-1==[null,""].indexOf(l[k])&&m.append("<div>"+k+": "+l[k]+"</div>");g&&h.appendChild(g)}if((a.forEachProperty instanceof Function||a.properties)&&($(h).css("text-align","center"),a.properties?objectforeach(a.properties,function(a,b){-1!==["nexrad","uaib"].indexOf(b)?a=c?c(b.toUpperCase()+":"+(a?"YES":"NO")):b.toUpperCase()+": "+(a?"YES":"NO")+"</div>":"url"===b?a="<p>"+a+"</p>":c&&(a=c(a)),h.append(a)}):a.forEachProperty(function(a,b){a&&(a=a.toString(),h.append(-1!==a.indexOf("<img")||-1!==a.indexOf("</a>")?a:'<p class="popupLine"><span class="attrKey">'+b.split("_").join(" ")+'</span><span class="attrVal">'+a+"</span></p>"))})),!b.noPopupZoomTo&&h.find(".popup-button:not(.station-link)").length<1){$("<div>Zoom to selected</div>").on("click",zoomToLayer.bind(a,a)).addClass("popup-button").appendTo(h)}popupToSideBar(d)}function handlePredictions(a,b){if(b!==google.maps.places.PlacesServiceStatus.OK)return console.log(b);var c=document.getElementById("searchTextField").value===this.toString();if(!c)return!1;a.forEach(function(a){addResultToPACContainer(this.value,{label:a.description,onclick:function(b){changeSelectedResultItem(b),placesService.getDetails({placeId:a.place_id},handlePlaceServiceResponse)}})});var d=$("#results");(d.hasClass("hidden")||"none"===d.css("display"))&&switchLeftPaneContent({showitem:d.appendTo("#legend").show(),name:"Results"})}function handlePlaceServiceResponse(a,b){return b!==google.maps.places.PlacesServiceStatus.OK?console.log(b):(showLoading("<span>zooming to "+(a.name||"selection")+"</span>"),a.geometry.viewport?app.map.fitBounds(a.geometry.viewport):(app.map.setCenter(a.geometry.location),app.map.setZoom(17)),void hideLoading())}function initSearch(){var a=document.getElementById("searchTextField"),b=new google.maps.places.AutocompleteService;return $(a).on("keyup",function(c){-1===[9,37,38,39,40].indexOf(c.which)&&a.value.length>0&&($("#results").children().remove(),searchLayers.call(this,c,app.layers),b.getPlacePredictions({input:this.value,bounds:app.map.getBounds(),location:app.map.getCenter(),radius:5e3,types:["geocode"],rankBy:"DISTANCE"},handlePredictions.bind(this.value))),$(a).removeClass("notfound")}).on("keydown",function(a){-1!==[9,37,38,39,40].indexOf(a.which)&&a.preventDefault()}).on("focusin",function(){$(this).addClass("focused")}).on("focusout",function(){$(this).removeClass("focused")}),google.maps.event.addListener(app.map,"mousedown",function(){$("#searchTextField").removeClass("focused")}),this}function getMapExtent(){var a=app.map.getBounds(),b=a.getSouthWest().lat(),c=a.getSouthWest().lng(),d=a.getNorthEast().lat(),e=a.getNorthEast().lng();return[c,b,e,d]}function startApp(){extendGoogle(),$(window).width()<500&&($(".legendToggle").trigger("click"),$(".cansplit.split").removeClass("split")),init(),hideLoading()}!function(){function extractString_(a,b,c){var d=""===b?0:a.indexOf(b),e=""===c?a.length:a.indexOf(c,d+b.length);return a.substring(d+b.length,e)}function isString_(a){return a&&"string"==typeof a}function isArray_(a){return a&&a.splice}function isNumber_(a){return"number"==typeof a}function augmentObject_(a,b,c){if(a&&b){var d;for(d in a)!c&&d in b||(b[d]=a[d])}return b}function triggerEvent_(){G.event.trigger.apply(this,arguments)}function handleErr_(a,b){a&&b&&b.error&&a(b.error)}function formatTimeString_(a,b){var c="";return a&&(c+=a.getTime()-6e4*a.getTimezoneOffset()),b&&(c+=", "+(b.getTime()-6e4*b.getTimezoneOffset())),c}function setNodeOpacity_(a,b){if(b=Math.min(Math.max(b,0),1),a){var c=a.style;"undefined"!=typeof c.opacity&&(c.opacity=b),"undefined"!=typeof c.filters&&(c.filters.alpha.opacity=Math.floor(100*b)),"undefined"!=typeof c.filter&&(c.filter="alpha(opacity:"+Math.floor(100*b)+")")}}function getLayerDefsString_(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length>0&&(b+=";"),b+=c+":"+a[c]);return b}function getXmlHttp_(){if("undefined"==typeof XMLHttpRequest){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(b){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(c){}throw new Error("This browser does not support XMLHttpRequest.")}return new XMLHttpRequest}function getGeometryType_(a){var b=a;return isArray_(a)&&a.length>0&&(b=a[0]),b instanceof G.LatLng||b instanceof G.Marker?isArray_(a)&&a.length>1?GeometryType.MULTIPOINT:GeometryType.POINT:b instanceof G.Polyline?GeometryType.POLYLINE:b instanceof G.Polygon?GeometryType.POLYGON:b instanceof G.LatLngBounds?GeometryType.ENVELOPE:void 0!==b.x&&void 0!==b.y?GeometryType.POINT:b.points?GeometryType.MULTIPOINT:b.paths?GeometryType.POLYLINE:b.rings?GeometryType.POLYGON:null}function isOverlay_(a){var b=a;return isArray_(a)&&a.length>0&&(b=a[0]),isArray_(b)&&b.length>0&&(b=b[0]),b instanceof G.LatLng||b instanceof G.Marker||b instanceof G.Polyline||b instanceof G.Polygon||b instanceof G.LatLngBounds?!0:!1}function formatSRParam_(a){return a?isNumber_(a)?a:a.wkid?a.wkid:a.toJSON():null}function fromLatLngsToJSON_(a,b){for(var c,d=[],e=0,f=a.getLength();f>e;e++)c=a.getAt(e),d.push("["+c.lng()+","+c.lat()+"]");return b&&d.length>0&&d.push("["+a.getAt(0).lng()+","+a.getAt(0).lat()+"]"),d.join(",")}function fromOverlaysToJSON_(a){var b,c,d,e,f=getGeometryType_(a),g="{";switch(f){case GeometryType.POINT:b=isArray_(a)?a[0]:a,b instanceof G.Marker&&(b=b.getPosition()),g+="x:"+b.lng()+",y:"+b.lat();break;case GeometryType.MULTIPOINT:for(e=[],d=0;d<a.length;d++)b=a[d]instanceof G.Marker?a[d].getPosition():a[d],e.push("["+b.lng()+","+b.lat()+"]");g+="points: ["+e.join(",")+"]";break;case GeometryType.POLYLINE:for(e=[],c=isArray_(a)?a:[a],d=0;d<c.length;d++)e.push("["+fromLatLngsToJSON_(c[d].getPath())+"]");g+="paths:["+e.join(",")+"]";break;case GeometryType.POLYGON:e=[],b=isArray_(a)?a[0]:a;var h=b.getPaths();for(d=0;d<h.getLength();d++)e.push("["+fromLatLngsToJSON_(h.getAt(d),!0)+"]");g+="rings:["+e.join(",")+"]";break;case GeometryType.ENVELOPE:b=isArray_(a)?a[0]:a,g+="xmin:"+b.getSouthWest().lng()+",ymin:"+b.getSouthWest().lat()+",xmax:"+b.getNorthEast().lng()+",ymax:"+b.getNorthEast().lat()}return g+=", spatialReference:{wkid:4326}",g+="}"}function fromGeometryToJSON_(a){function b(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push("["+a[c][0]+","+a[c][1]+"]");return"["+b.join(",")+"]"}function c(a){for(var c=[],d=0,e=a.length;e>d;d++)c.push(b(a[d]));return"["+c.join(",")+"]"}var d="{";return a.x?d+="x:"+a.x+",y:"+a.y:a.xmin?d+="xmin:"+a.xmin+",ymin:"+a.ymin+",xmax:"+a.xmax+",ymax:"+a.ymax:a.points?d+="points:"+b(a.points):a.paths?d+="paths:"+c(a.paths):a.rings&&(d+="rings:"+c(a.rings)),d+="}"}function fromEnvelopeToLatLngBounds_(a){var b=spatialReferences_[a.spatialReference.wkid||a.spatialReference.wkt];b=b||WGS84;var c=b.inverse([a.xmin,a.ymin]),d=b.inverse([a.xmax,a.ymax]);return new G.LatLngBounds(new G.LatLng(c[1],c[0]),new G.LatLng(d[1],d[0]))}function fromJSONToOverlays_(a,b){var c,d,e,f,g,h,i,j,k,l=null;if(b=b||{},a)if(l=[],a.x)c=new G.Marker(augmentObject_(b.markerOptions||b,{position:new G.LatLng(a.y,a.x)})),l.push(c);else{if(h=a.points||a.paths||a.rings,!h)return l;var m=[];for(d=0,e=h.length;e>d;d++)if(i=h[d],a.points)c=new G.Marker(augmentObject_(b.markerOptions||b,{position:new G.LatLng(i[1],i[0])})),l.push(c);else{for(k=[],f=0,g=i.length;g>f;f++)j=i[f],k.push(new G.LatLng(j[1],j[0]));a.paths?(c=new G.Polyline(augmentObject_(b.polylineOptions||b,{path:k})),l.push(c)):a.rings&&m.push(k)}a.rings&&(c=new G.Polygon(augmentObject_(b.polygonOptions||b,{paths:m})),l.push(c))}return l}function parseFeatures_(a,b){if(a){var c,d,e;for(c=0,d=a.length;d>c;c++)e=a[c],e.geometry&&(e.geometry=fromJSONToOverlays_(e.geometry,b))}}function formatRequestString_(a){var b;if("object"==typeof a){if(isArray_(a)){b=[];for(var c=0,d=a.length;d>c;c++)b.push(formatRequestString_(a[c]));return"["+b.join(",")+"]"}if(isOverlay_(a))return fromOverlaysToJSON_(a);if(a.toJSON)return a.toJSON();b="";for(var e in a)a.hasOwnProperty(e)&&(b.length>0&&(b+=", "),b+=e+":"+formatRequestString_(a[e]));return"{"+b+"}"}return a.toString()}function fromLatLngsToFeatureSet_(a){var b,c,d,e=[];for(b=0,c=a.length;c>b;b++)d=a[b],d instanceof G.Marker&&(d=d.getPosition()),e.push({geometry:{x:d.lng(),y:d.lat(),spatialReference:{wkid:4326}}});return{type:'"features"',features:e,doNotLocateOnRestrictedElements:!1}}function prepareGeometryParams_(a){var b={};if(!a)return null;var c,d,e=[];if(a.geometries&&a.geometries.length>0){c=a.geometries[0],d=isOverlay_(c);for(var f=0,g=a.geometries.length;g>f;f++)e.push(d?fromOverlaysToJSON_(a.geometries[f]):fromGeometryToJSON_(a.geometries[f]))}return a.geometryType||(a.geometryType=getGeometryType_(c)),d?b.inSR=WGS84.wkid:a.inSpatialReference&&(b.inSR=formatSRParam_(a.inSpatialReference)),a.outSpatialReference&&(b.outSR=formatSRParam_(a.outSpatialReference)),b.geometries='{geometryType:"'+a.geometryType+'", geometries:['+e.join(",")+"]}",b}function log_(a){if(window.console)window.console.log(a);else{var b=document.getElementById("_ags_log");b&&(b.innerHTML=b.innerHTML+a+"<br/>")}}function formatParams_(a){var b="";if(a){a.f=a.f||"json";for(var c in a)if(a.hasOwnProperty(c)&&null!==a[c]&&void 0!==a[c]){var d=formatRequestString_(a[c]);b+=(b.length>0?"&":"")+(c+"="+(escape?escape(d):encodeURIComponent(d)))}}return b}function callback_(a,b){for(var c=[],d=2,e=arguments.length;e>d;d++)c.push(arguments[d]);return function(){a.apply(b,c)}}function addCopyrightInfo_(a,b,c){b.hasLoaded()?a.push(b.copyrightText):G.event.addListenerOnce(b,"load",function(){setCopyrightInfo_(c)
})}function setCopyrightInfo_(a){var b=null;if(a){var c=a.controls[G.ControlPosition.BOTTOM_RIGHT];if(c)for(var d=0,e=c.getLength();e>d;d++)if("agsCopyrights"===c.getAt(d).id){b=c.getAt(d);break}b||(b=document.createElement("div"),b.style.fontFamily="Arial,sans-serif",b.style.fontSize="10px",b.style.textAlign="right",b.id="agsCopyrights",a.controls[G.ControlPosition.BOTTOM_RIGHT].push(b),G.event.addListener(a,"maptypeid_changed",function(){setCopyrightInfo_(a)}));var f,g=a.agsOverlays,h=[];if(g)for(var d=0,e=g.getLength();e>d;d++)addCopyrightInfo_(h,g.getAt(d).mapService_,a);var i=a.overlayMapTypes;if(i)for(var d=0,e=i.getLength();e>d;d++)if(f=i.getAt(d),f instanceof MapType)for(var j=0,k=f.tileLayers_.length;k>j;j++)addCopyrightInfo_(h,f.tileLayers_[j].mapService_,a);if(f=a.mapTypes.get(a.getMapTypeId()),f instanceof MapType){for(var d=0,e=f.tileLayers_.length;e>d;d++)addCopyrightInfo_(h,f.tileLayers_[d].mapService_,a);b.style.color=f.negative?"#ffffff":"#000000"}b.innerHTML=h.join("<br/>")}}function getJSON_(url,params,callbackName,callbackFn){var sid="ags_jsonp_"+jsonpID_++ +"_"+Math.floor(1e6*Math.random()),script=null;params=params||{},params[callbackName||"callback"]="ags_jsonp."+sid;var query=formatParams_(params),head=document.getElementsByTagName("head")[0];if(!head)throw new Error("document must have header tag");var jsonpcallback=function(){window.ags_jsonp[sid]&&delete window.ags_jsonp[sid],script&&head.removeChild(script),script=null,callbackFn.apply(null,arguments),triggerEvent_(Util,"jsonpend",sid)};if(window.ags_jsonp[sid]=jsonpcallback,(query+url).length<2e3&&!Config.alwaysUseProxy)script=document.createElement("script"),script.src=url+(-1===url.indexOf("?")?"?":"&")+query,script.id=sid,head.appendChild(script);else{var loc=window.location,dom=loc.protocol+"//"+loc.hostname+(loc.port&&80!==loc.port?":"+loc.port+"/":""),useProxy=!0;if(-1!==url.toLowerCase().indexOf(dom.toLowerCase())&&(useProxy=!1),Config.alwaysUseProxy&&(useProxy=!0),useProxy&&!Config.proxyUrl)throw new Error("No proxyUrl property in Config is defined");var xmlhttp=getXmlHttp_();xmlhttp.onreadystatechange=function(){if(4===xmlhttp.readyState){if(200!==xmlhttp.status)throw new Error("Error code "+xmlhttp.status);eval(xmlhttp.responseText)}},xmlhttp.open("POST",useProxy?Config.proxyUrl+"?"+url:url,!0),xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmlhttp.send(query)}return triggerEvent_(Util,"jsonpstart",sid),sid}function SpatialReference(a){a=a||{},this.wkid=a.wkid,this.wkt=a.wkt}function Geographic(a){a=a||{},SpatialReference.call(this,a)}function LambertConformalConic(a){a=a||{},SpatialReference.call(this,a);var b=a.inverse_flattening,c=a.standard_parallel_1*RAD_DEG,d=a.standard_parallel_2*RAD_DEG,e=a.latitude_of_origin*RAD_DEG;this.a_=a.semi_major/a.unit,this.lamda0_=a.central_meridian*RAD_DEG,this.FE_=a.false_easting,this.FN_=a.false_northing;var f=1/b,g=2*f-f*f;this.e_=Math.sqrt(g);var h=this.calc_m_(c,g),i=this.calc_m_(d,g),j=this.calc_t_(e,this.e_),k=this.calc_t_(c,this.e_),l=this.calc_t_(d,this.e_);this.n_=Math.log(h/i)/Math.log(k/l),this.F_=h/(this.n_*Math.pow(k,this.n_)),this.rho0_=this.calc_rho_(this.a_,this.F_,j,this.n_)}function TransverseMercator(a){a=a||{},SpatialReference.call(this,a),this.a_=a.semi_major/a.unit;var b=a.inverse_flattening;this.k0_=a.scale_factor;var c=a.latitude_of_origin*RAD_DEG;this.lamda0_=a.central_meridian*RAD_DEG,this.FE_=a.false_easting,this.FN_=a.false_northing;var d=1/b;this.es_=2*d-d*d,this.ep4_=this.es_*this.es_,this.ep6_=this.ep4_*this.es_,this.eas_=this.es_/(1-this.es_),this.M0_=this.calc_m_(c,this.a_,this.es_,this.ep4_,this.ep6_)}function SphereMercator(a){a=a||{},SpatialReference.call(this,a),this.a_=(a.semi_major||6378137)/(a.unit||1),this.lamda0_=(a.central_meridian||0)*RAD_DEG}function Albers(a){a=a||{},SpatialReference.call(this,a);var b=a.inverse_flattening,c=a.standard_parallel_1*RAD_DEG,d=a.standard_parallel_2*RAD_DEG,e=a.latitude_of_origin*RAD_DEG;this.a_=a.semi_major/a.unit,this.lamda0_=a.central_meridian*RAD_DEG,this.FE_=a.false_easting,this.FN_=a.false_northing;var f=1/b,g=2*f-f*f;this.e_=Math.sqrt(g);var h=this.calc_m_(c,g),i=this.calc_m_(d,g),j=this.calc_q_(c,this.e_),k=this.calc_q_(d,this.e_),l=this.calc_q_(e,this.e_);this.n_=(h*h-i*i)/(k-j),this.C_=h*h+this.n_*j,this.rho0_=this.calc_rho_(this.a_,this.C_,this.n_,l)}function Catalog(a){this.url=a;var b=this;getJSON_(a,{},"",function(a){augmentObject_(a,b),triggerEvent_(b,"load")})}function Layer(a){this.url=a,this.definition=null}function MapService(a,b){this.url=a,this.loaded_=!1;var c=a.split("/");if(this.name=c[c.length-2].replace(/_/g," "),b=b||{},b.delayLoad){var d=this;window.setTimeout(function(){d.loadServiceInfo()},1e3*b.delayLoad)}else this.loadServiceInfo()}function GeocodeService(a){this.url=a,this.loaded_=!1;var b=this;getJSON_(a,{},"",function(a){b.init_(a)})}function GeometryService(a){this.url=a,this.t="geocodeservice"}function GPService(a){this.url=a,this.loaded_=!1;var b=this;getJSON_(a,{},"",function(a){augmentObject_(a,b),b.loaded_=!0,triggerEvent_(b,"load")})}function GPTask(a){this.url=a,this.loaded_=!1;var b=this;getJSON_(a,{},"",function(a){augmentObject_(a,b),b.loaded_=!0,triggerEvent_(b,"load")})}function NetworkService(a){this.url=a,this.loaded_=!1;var b=this;getJSON_(a,{},"",function(a){augmentObject_(a,b),b.loaded_=!0,triggerEvent_(b,"load")})}function RouteTask(a){this.url=a}function Projection(a){if(this.lods_=a?a.lods:null,this.spatialReference_=a?spatialReferences_[a.spatialReference.wkid||a.spatialReference.wkt]:WEB_MERCATOR,!this.spatialReference_)throw new Error("unsupported Spatial Reference");if(this.resolution0_=a?a.lods[0].resolution:156543.033928,this.minZoom=Math.floor(Math.log(this.spatialReference_.getCircum()/this.resolution0_/256)/Math.LN2+.5),this.maxZoom=a?this.minZoom+this.lods_.length-1:20,G.Size&&(this.tileSize_=a?new G.Size(a.cols,a.rows):new G.Size(256,256)),this.scale_=Math.pow(2,this.minZoom)*this.resolution0_,this.originX_=a?a.origin.x:-20037508.342787,this.originY_=a?a.origin.y:20037508.342787,a)for(var b,c=0;c<a.lods.length-1;c++)if(b=a.lods[c].resolution/a.lods[c+1].resolution,b>2.001||1.999>b)throw new Error("This type of map cache is not supported in V3. \nScale ratio between zoom levels must be 2")}function TileLayer(a,b){if(b=b||{},b.opacity&&(this.opacity_=b.opacity,delete b.opacity),augmentObject_(b,this),this.mapService_=a instanceof MapService?a:new MapService(a),b.hosts){var c=extractString_(this.mapService_.url,"","://"),d=extractString_(this.mapService_.url,"://","/"),e=extractString_(this.mapService_.url,c+"://"+d,"");this.urlTemplate_=c+"://"+b.hosts+e,this.numOfHosts_=parseInt(extractString_(b.hosts,"[","]"),10)}if(this.name=b.name||this.mapService_.name,this.maxZoom=b.maxZoom||19,this.minZoom=b.minZoom||0,this.dynaZoom=b.dynaZoom||this.maxZoom,this.mapService_.loaded_)this.init_(b);else{var f=this;G.event.addListenerOnce(this.mapService_,"load",function(){f.init_(b)})}this.tiles_={},this.map_=b.map}function MapType(a,b){b=b||{};var c;b.opacity&&(this.opacity_=b.opacity,delete b.opacity),augmentObject_(b,this);var d=a;if(isString_(a))d=[new TileLayer(a,b)];else if(a instanceof MapService)d=[new TileLayer(a,b)];else if(a instanceof TileLayer)d=[a];else if(a.length>0&&isString_(a[0]))for(d=[],c=0;c<a.length;c++)d[c]=new TileLayer(a[c],b);if(this.tileLayers_=d,this.tiles_={},void 0!==b.maxZoom)this.maxZoom=b.maxZoom;else{var e=0;for(c=0;c<d.length;c++)e=Math.max(e,d[c].maxZoom);this.maxZoom=e}d[0].projection_?(this.tileSize=d[0].projection_.tileSize_,this.projection=d[0].projection_):this.tileSize=new G.Size(256,256),this.name||(this.name=d[0].name)}function MapOverlay(a,b){b=b||{},this.mapService_=a instanceof MapService?a:new MapService(a),this.minZoom=b.minZoom,this.maxZoom=b.maxZoom,this.opacity_=b.opacity||1,this.exportOptions_=b.exportOptions||{},this.drawing_=!1,this.needsNewRefresh_=!1,this.overlay_=null,this.div_=null,b.map&&this.setMap(b.map),this.map_=null,this.listeners_=[]}function ImageOverlay(a,b,c,d){this.bounds_=a,this.url_=b,this.map_=c,this.div_=null,this.op_=d,this.setMap(c)}function CopyrightControl(a){this.map_=a,setCopyrightInfo_(a)}var gmaps=gmaps||{},RAD_DEG=Math.PI/180,jsonpID_=0;window.ags_jsonp=window.ags_jsonp||{};var G=google.maps,WGS84,NAD83,WEB_MERCATOR,WEB_MERCATOR_AUX,Config={proxyUrl:null,alwaysUseProxy:!1},spatialReferences_={},Util={},GeometryType={POINT:"esriGeometryPoint",MULTIPOINT:"esriGeometryMultipoint",POLYLINE:"esriGeometryPolyline",POLYGON:"esriGeometryPolygon",ENVELOPE:"esriGeometryEnvelope"};Util.getJSON=function(a,b,c,d){getJSON_(a,b,c,d)},Util.addToMap=function(a,b){if(isArray_(b))for(var c,d=0,e=b.length;e>d;d++)c=b[d],isArray_(c)?Util.addToMap(a,c):isOverlay_(c)&&c.setMap(a)},Util.removeFromMap=function(a,b){Util.addToMap(null,a),b&&(a.length=0)},SpatialReference.prototype.forward=function(a){return a},SpatialReference.prototype.inverse=function(a){return a},SpatialReference.prototype.getCircum=function(){return 360},SpatialReference.prototype.toJSON=function(){return"{"+(this.wkid?" wkid:"+this.wkid:"wkt: '"+this.wkt+"'")+"}"},Geographic.prototype=new SpatialReference,LambertConformalConic.prototype=new SpatialReference,LambertConformalConic.prototype.calc_m_=function(a,b){var c=Math.sin(a);return Math.cos(a)/Math.sqrt(1-b*c*c)},LambertConformalConic.prototype.calc_t_=function(a,b){var c=b*Math.sin(a);return Math.tan(Math.PI/4-a/2)/Math.pow((1-c)/(1+c),b/2)},LambertConformalConic.prototype.calc_rho_=function(a,b,c,d){return a*b*Math.pow(c,d)},LambertConformalConic.prototype.calc_phi_=function(a,b,c){var d=b*Math.sin(c);return Math.PI/2-2*Math.atan(a*Math.pow((1-d)/(1+d),b/2))},LambertConformalConic.prototype.solve_phi_=function(a,b,c){for(var d=0,e=c,f=this.calc_phi_(a,b,e);Math.abs(f-e)>1e-9&&10>d;)d++,e=f,f=this.calc_phi_(a,b,e);return f},LambertConformalConic.prototype.forward=function(a){var b=a[1]*RAD_DEG,c=a[0]*RAD_DEG,d=this.calc_t_(b,this.e_),e=this.calc_rho_(this.a_,this.F_,d,this.n_),f=this.n_*(c-this.lamda0_),g=this.FE_+e*Math.sin(f),h=this.FN_+this.rho0_-e*Math.cos(f);return[g,h]},LambertConformalConic.prototype.inverse=function(a){var b=a[0]-this.FE_,c=a[1]-this.FN_,d=Math.atan(b/(this.rho0_-c)),e=(this.n_>0?1:-1)*Math.sqrt(b*b+(this.rho0_-c)*(this.rho0_-c)),f=Math.pow(e/(this.a_*this.F_),1/this.n_),g=Math.PI/2-2*Math.atan(f),h=this.solve_phi_(f,this.e_,g),i=d/this.n_+this.lamda0_;return[i/RAD_DEG,h/RAD_DEG]},LambertConformalConic.prototype.getCircum=function(){return 2*Math.PI*this.a_},TransverseMercator.prototype=new SpatialReference,TransverseMercator.prototype.calc_m_=function(a,b,c,d,e){return b*((1-c/4-3*d/64-5*e/256)*a-(3*c/8+3*d/32+45*e/1024)*Math.sin(2*a)+(15*d/256+45*e/1024)*Math.sin(4*a)-35*e/3072*Math.sin(6*a))},TransverseMercator.prototype.forward=function(a){var b=a[1]*RAD_DEG,c=a[0]*RAD_DEG,d=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(b),2)),e=Math.pow(Math.tan(b),2),f=this.eas_*Math.pow(Math.cos(b),2),g=(c-this.lamda0_)*Math.cos(b),h=this.calc_m_(b,this.a_,this.es_,this.ep4_,this.ep6_),i=this.FE_+this.k0_*d*(g+(1-e+f)*Math.pow(g,3)/6+(5-18*e+e*e+72*f-58*this.eas_)*Math.pow(g,5)/120),j=this.FN_+this.k0_*(h-this.M0_)+d*Math.tan(b)*(g*g/2+(5-e+9*f+4*f*f)*Math.pow(g,4)/120+(61-58*e+e*e+600*f-330*this.eas_)*Math.pow(g,6)/720);return[i,j]},TransverseMercator.prototype.inverse=function(a){var b=a[0],c=a[1],d=(1-Math.sqrt(1-this.es_))/(1+Math.sqrt(1-this.es_)),e=this.M0_+(c-this.FN_)/this.k0_,f=e/(this.a_*(1-this.es_/4-3*this.ep4_/64-5*this.ep6_/256)),g=f+(3*d/2-27*Math.pow(d,3)/32)*Math.sin(2*f)+(21*d*d/16-55*Math.pow(d,4)/32)*Math.sin(4*f)+151*Math.pow(d,3)/6*Math.sin(6*f)+1097*Math.pow(d,4)/512*Math.sin(8*f),h=this.eas_*Math.pow(Math.cos(g),2),i=Math.pow(Math.tan(g),2),j=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(g),2)),k=this.a_*(1-this.es_)/Math.pow(1-this.es_*Math.pow(Math.sin(g),2),1.5),l=(b-this.FE_)/(j*this.k0_),m=g-j*Math.tan(g)/k*(l*l/2-(5+3*i+10*h-4*h*h-9*this.eas_)*Math.pow(l,4)/24+(61+90*i+28*h+45*i*i-252*this.eas_-3*h*h)*Math.pow(l,6)/720),n=this.lamda0_+(l-(1+2*i+h)*Math.pow(l,3)/6+(5-2*h+28*i-3*h*h+8*this.eas_+24*i*i)*Math.pow(l,5)/120)/Math.cos(g);return[n/RAD_DEG,m/RAD_DEG]},TransverseMercator.prototype.getCircum=function(){return 2*Math.PI*this.a_},SphereMercator.prototype=new SpatialReference,SphereMercator.prototype.forward=function(a){var b=a[1]*RAD_DEG,c=a[0]*RAD_DEG,d=this.a_*(c-this.lamda0_),e=this.a_/2*Math.log((1+Math.sin(b))/(1-Math.sin(b)));return[d,e]},SphereMercator.prototype.inverse=function(a){var b=a[0],c=a[1],d=Math.PI/2-2*Math.atan(Math.exp(-c/this.a_)),e=b/this.a_+this.lamda0_;return[e/RAD_DEG,d/RAD_DEG]},SphereMercator.prototype.getCircum=function(){return 2*Math.PI*this.a_},Albers.prototype=new SpatialReference,Albers.prototype.calc_m_=function(a,b){var c=Math.sin(a);return Math.cos(a)/Math.sqrt(1-b*c*c)},Albers.prototype.calc_q_=function(a,b){var c=b*Math.sin(a);return(1-b*b)*(Math.sin(a)/(1-c*c)-1/(2*b)*Math.log((1-c)/(1+c)))},Albers.prototype.calc_rho_=function(a,b,c,d){return a*Math.sqrt(b-c*d)/c},Albers.prototype.calc_phi_=function(a,b,c){var d=b*Math.sin(c);return c+(1-d*d)*(1-d*d)/(2*Math.cos(c))*(a/(1-b*b)-Math.sin(c)/(1-d*d)+Math.log((1-d)/(1+d))/(2*b))},Albers.prototype.solve_phi_=function(a,b,c){for(var d=0,e=c,f=this.calc_phi_(a,b,e);Math.abs(f-e)>1e-8&&10>d;)d++,e=f,f=this.calc_phi_(a,b,e);return f},Albers.prototype.forward=function(a){var b=a[1]*RAD_DEG,c=a[0]*RAD_DEG,d=this.calc_q_(b,this.e_),e=this.calc_rho_(this.a_,this.C_,this.n_,d),f=this.n_*(c-this.lamda0_),g=this.FE_+e*Math.sin(f),h=this.FN_+this.rho0_-e*Math.cos(f);return[g,h]},Albers.prototype.inverse=function(a){var b=a[0]-this.FE_,c=a[1]-this.FN_,d=Math.sqrt(b*b+(this.rho0_-c)*(this.rho0_-c)),e=this.n_>0?1:-1,f=Math.atan(e*b/(e*this.rho0_-e*c)),g=(this.C_-d*d*this.n_*this.n_/(this.a_*this.a_))/this.n_,h=Math.asin(g/2),i=this.solve_phi_(g,this.e_,h),j=f/this.n_+this.lamda0_;return[j/RAD_DEG,i/RAD_DEG]},Albers.prototype.getCircum=function(){return 2*Math.PI*this.a_},Albers.prototype.getCircum=function(){return 2*Math.PI*this.a_},WGS84=new Geographic({wkid:4326}),NAD83=new Geographic({wkid:4269}),WEB_MERCATOR=new SphereMercator({wkid:102113,semi_major:6378137,central_meridian:0,unit:1}),WEB_MERCATOR_AUX=new SphereMercator({wkid:102100,semi_major:6378137,central_meridian:0,unit:1}),spatialReferences_={4326:WGS84,4269:NAD83,102113:WEB_MERCATOR,102100:WEB_MERCATOR_AUX},SpatialReference.WGS84=WGS84,SpatialReference.NAD83=NAD83,SpatialReference.WEB_MERCATOR=WEB_MERCATOR,SpatialReference.WEB_MERCATOR_AUX=WEB_MERCATOR_AUX,Util.registerSR=function(a,b){var c=spatialReferences_[""+a];if(c)return c;if(b instanceof SpatialReference)spatialReferences_[""+a]=b,c=b;else{var d=b||a,e={wkt:a};a===parseInt(a,10)&&(e={wkid:a});var f=extractString_(d,'PROJECTION["','"]'),g=extractString_(d,"SPHEROID[","]").split(",");switch(""!==f&&(e.unit=parseFloat(extractString_(extractString_(d,"PROJECTION",""),"UNIT[","]").split(",")[1]),e.semi_major=parseFloat(g[1]),e.inverse_flattening=parseFloat(g[2]),e.latitude_of_origin=parseFloat(extractString_(d,'"Latitude_Of_Origin",',"]")),e.central_meridian=parseFloat(extractString_(d,'"Central_Meridian",',"]")),e.false_easting=parseFloat(extractString_(d,'"False_Easting",',"]")),e.false_northing=parseFloat(extractString_(d,'"False_Northing",',"]"))),f){case"":c=new SpatialReference(e);break;case"Lambert_Conformal_Conic":e.standard_parallel_1=parseFloat(extractString_(d,'"Standard_Parallel_1",',"]")),e.standard_parallel_2=parseFloat(extractString_(d,'"Standard_Parallel_2",',"]")),c=new LambertConformalConic(e);break;case"Transverse_Mercator":e.scale_factor=parseFloat(extractString_(d,'"Scale_Factor",',"]")),c=new TransverseMercator(e);break;case"Albers":e.standard_parallel_1=parseFloat(extractString_(d,'"Standard_Parallel_1",',"]")),e.standard_parallel_2=parseFloat(extractString_(d,'"Standard_Parallel_2",',"]")),c=new Albers(e);break;default:throw new Error(f+"  not supported")}c&&(spatialReferences_[""+a]=c)}return c},Layer.prototype.load=function(){var a=this;this.loaded_||getJSON_(this.url,{},"",function(b){augmentObject_(b,a),a.loaded_=!0,triggerEvent_(a,"load")})},Layer.prototype.isInScale=function(a){return this.maxScale&&this.maxScale>a?!1:this.minScale&&this.minScale<a?!1:!0};var SpatialRelationship={INTERSECTS:"esriSpatialRelIntersects",CONTAINS:"esriSpatialRelContains",CROSSES:"esriSpatialRelCrosses",ENVELOPE_INTERSECTS:"esriSpatialRelEnvelopeIntersects",INDEX_INTERSECTS:"esriSpatialRelIndexIntersects",OVERLAPS:"esriSpatialRelOverlaps",TOUCHES:"esriSpatialRelTouches",WITHIN:"esriSpatialRelWithin"};Layer.prototype.query=function(a,b,c){if(a){var d=augmentObject_(a,{});a.geometry&&!isString_(a.geometry)&&(d.geometry=fromOverlaysToJSON_(a.geometry),d.geometryType=getGeometryType_(a.geometry),d.inSR=4326),a.spatialRelationship&&(d.spatialRel=a.spatialRelationship,delete d.spatialRelationship),a.outFields&&isArray_(a.outFields)&&(d.outFields=a.outFields.join(",")),a.objectIds&&(d.objectIds=a.objectIds.join(",")),a.time&&(d.time=formatTimeString_(a.time,a.endTime)),d.outSR=4326,d.returnGeometry=a.returnGeometry===!1?!1:!0,d.returnIdsOnly=a.returnIdsOnly===!0?!0:!1,delete d.overlayOptions,getJSON_(this.url+"/query",d,"",function(d){parseFeatures_(d.features,a.overlayOptions),b(d,d.error),handleErr_(c,d)})}},Layer.prototype.queryRelatedRecords=function(a,b,c){if(a){var d=augmentObject_(a,{});d.f=d.f||"json",d.outFields&&!isString_(d.outFields)&&(d.outFields=d.outFields.join(",")),d.returnGeometry=d.returnGeometry===!1?!1:!0,getJSON_(this.url+"/query",d,"",function(a){handleErr_(c,a),b(a)})}},MapService.prototype.loadServiceInfo=function(){var a=this;getJSON_(this.url,{},"",function(b){a.init_(b)})},MapService.prototype.init_=function(a){var b=this;if(a.error)throw new Error(a.error.message);augmentObject_(a,this),this.spatialReference=a.spatialReference.wkt?Util.registerSR(a.spatialReference.wkt):spatialReferences_[a.spatialReference.wkid],void 0!==a.tables?getJSON_(this.url+"/layers",{},"",function(a){b.initLayers_(a),getJSON_(b.url+"/legend",{},"",function(a){b.initLegend_(a),b.setLoaded_()})}):(b.initLayers_(a),b.setLoaded_())},MapService.prototype.setLoaded_=function(){this.loaded_=!0,triggerEvent_(this,"load")},MapService.prototype.initLayers_=function(a){var b=[],c=[];this.layers=b,a.tables&&(this.tables=c);var d,e,f,g;for(e=0,f=a.layers.length;f>e;e++)g=a.layers[e],d=new Layer(this.url+"/"+g.id),augmentObject_(g,d),d.visible=d.defaultVisibility,b.push(d);if(a.tables)for(e=0,f=a.tables.length;f>e;e++)g=a.tables[e],d=new Layer(this.url+"/"+g.id),augmentObject_(g,d),c.push(d);for(e=0,f=b.length;f>e;e++)if(d=b[e],d.subLayerIds){d.subLayers=[];for(var h=0,i=d.subLayerIds.length;i>h;h++){var j=this.getLayer(d.subLayerIds[h]);d.subLayers.push(j),j.parentLayer=d}}},MapService.prototype.initLegend_=function(a){var b=this.layers;if(a.layers){var c,d,e,f;for(d=0,e=a.layers.length;e>d;d++)f=a.layers[d],c=b[f.layerId],augmentObject_(f,c)}},MapService.prototype.getLayer=function(a){var b=this.layers;if(b)for(var c=0,d=b.length;d>c;c++){if(a===b[c].id)return b[c];if(isString_(a)&&b[c].name.toLowerCase()===a.toLowerCase())return b[c]}return null},MapService.prototype.getLayerDefs_=function(){var a={};if(this.layers)for(var b=0,c=this.layers.length;c>b;b++){var d=this.layers[b];d.definition&&(a[String(d.id)]=d.definition)}return a},MapService.prototype.hasLoaded=function(){return this.loaded_},MapService.prototype.getVisibleLayerIds_=function(){var a=[];if(this.layers){var b,c,d;for(c=0,d=this.layers.length;d>c;c++)if(b=this.layers[c],b.subLayers)for(var e=0,f=b.subLayers.length;f>e;e++)if(b.subLayers[e].visible===!1){b.visible=!1;break}for(c=0,d=this.layers.length;d>c;c++)b=this.layers[c],b.subLayers&&b.subLayers.length>0||b.visible===!0&&a.push(b.id)}return a},MapService.prototype.getInitialBounds=function(){return this.initialExtent?(this.initBounds_=this.initBounds_||fromEnvelopeToLatLngBounds_(this.initialExtent),this.initBounds_):null},MapService.prototype.getFullBounds=function(){return this.fullExtent?(this.fullBounds_=this.fullBounds_||fromEnvelopeToLatLngBounds_(this.fullExtent),this.fullBounds_):null},MapService.prototype.exportMap=function(a,b,c){if(a&&a.bounds){console.log(a);var d={};d.f=a.f;var e=a.bounds,f=e.getSouthWest().lng(),g=e.getNorthEast().lng();f>g&&(f-=180),d.bbox=""+f+","+e.getSouthWest().lat()+","+g+","+e.getNorthEast().lat(),d.size=""+a.width+","+a.height,d.dpi=a.dpi,a.imageSR&&(d.imageSR=a.imageSR.wkid?a.imageSR.wkid:"{wkt:"+a.imageSR.wkt+"}"),d.bboxSR="4326",d.format=a.format;var h=a.layerDefinitions;void 0===h&&(h=this.getLayerDefs_()),d.layerDefs=getLayerDefsString_(h);var i=a.layerIds,j=a.layerOption||"show";if(void 0===i&&(i=this.getVisibleLayerIds_()),i.length>0)d.layers=j+":"+i.join(",");else if(this.loaded_&&b)return void b({href:null});if(d.transparent=a.transparent===!1?!1:!0,a.time&&(d.time=formatTimeString_(a.time,a.endTime)),d.layerTimeOptions=a.layerTimeOptions,"image"===d.f)return this.url+"/export?"+formatParams_(d);var k=this;getJSON_(this.url+"/export",d,"",function(a){a.extent?(a.bounds=fromEnvelopeToLatLngBounds_(a.extent),log_("got "+a.bounds.toUrlValue()),delete a.extent,d.f="image",a.href=k.url+"/export?"+formatParams_(d),b(a)):handleErr_(c,a.error)})}},MapService.prototype.identify=function(a,b,c){if(a){var d={};d.geometry=fromOverlaysToJSON_(a.geometry),d.geometryType=getGeometryType_(a.geometry),d.mapExtent=fromOverlaysToJSON_(a.bounds),d.tolerance=a.tolerance||2,d.sr=4326,d.imageDisplay=""+a.width+","+a.height+","+(a.dpi||96),d.layers=a.layerOption||"all",a.layerIds&&(d.layers+=":"+a.layerIds.join(",")),a.layerDefs&&(d.layerDefs=getLayerDefsString_(a.layerDefs)),d.maxAllowableOffset=a.maxAllowableOffset,d.returnGeometry=a.returnGeometry===!1?!1:!0,getJSON_(this.url+"/identify",d,"",function(d){var e,f,g,h=null;if(d.results)for(h=[],e=0;e<d.results.length;e++)f=d.results[e],g=fromJSONToOverlays_(f.geometry,a.overlayOptions),f.feature={geometry:g,attributes:f.attributes},delete f.attributes;b(d),handleErr_(c,d)})}},MapService.prototype.find=function(a,b,c){if(a){var d=augmentObject_(a,{});a.layerIds&&(d.layers=a.layerIds.join(","),delete d.layerIds),a.searchFields&&(d.searchFields=a.searchFields.join(",")),d.contains=a.contains===!1?!1:!0,a.layerDefinitions&&(d.layerDefs=getLayerDefsString_(a.layerDefinitions),delete d.layerDefinitions),d.sr=4326,d.returnGeometry=a.returnGeometry===!1?!1:!0,getJSON_(this.url+"/find",d,"",function(d){var e,f,g,h=null;if(d.results)for(h=[],e=0;e<d.results.length;e++)f=d.results[e],g=fromJSONToOverlays_(f.geometry,a.overlayOptions),f.feature={geometry:g,attributes:f.attributes},delete f.attributes;b(d),handleErr_(c,d)})}},MapService.prototype.queryLayer=function(a,b,c,d){var e=this.getLayer(a);e&&e.query(b,c,d)},GeocodeService.prototype.init_=function(a){augmentObject_(a,this),a.spatialReference&&(this.spatialReference=spatialReferences_[a.spatialReference.wkid||a.spatialReference.wkt]||WGS84),this.loaded_=!0,triggerEvent_(this,"load")},GeocodeService.prototype.findAddressCandidates=function(a,b,c){var d=augmentObject_(a,{});d.inputs&&(augmentObject_(d.inputs,d),delete d.inputs),isArray_(d.outFields)&&(d.outFields=d.outFields.join(","));var e=this;getJSON_(this.url+"/findAddressCandidates",d,"",function(d){if(d.candidates)for(var f,g,h=[],i=0;i<d.candidates.length;i++)if(f=d.candidates[i],g=f.location,!isNaN(g.x)&&!isNaN(g.y)){var j=[g.x,g.y],k=e.spatialReference;a.outSR&&(k=spatialReferences_[a.outSR]),k&&(j=k.inverse(j)),f.location=new G.LatLng(j[1],j[0]),h[h.length]=f}b({candidates:h}),handleErr_(c,d)})},GeocodeService.prototype.geocode=function(a,b){this.findAddressCandidates(a,b)},GeocodeService.prototype.reverseGeocode=function(a,b,c){isString_(a.location)||(a.location=fromOverlaysToJSON_(a.location)),a.outSR=4326;var d=this;getJSON_(this.url+"/reverseGeocode",a,"",function(a){if(a.location){var e=a.location;if(!isNaN(e.x)&&!isNaN(e.y)){var f=[e.x,e.y];d.spatialReference&&(f=d.spatialReference.inverse(f)),a.location=new G.LatLng(f[1],f[0])}}b(a),handleErr_(c,a)})},GeometryService.prototype.project=function(a,b,c){var d=prepareGeometryParams_(a);getJSON_(this.url+"/project",d,"callback",function(d){var e=[];if(4326===a.outSpatialReference||4326===a.outSpatialReference.wkid){for(var f=0,g=d.geometries.length;g>f;f++)e.push(fromJSONToOverlays_(d.geometries[f]));d.geometries=e}b(d),handleErr_(c,d)})};var SRUnit={METER:9001,FOOT:9002,SURVEY_FOOT:9003,SURVEY_MILE:9035,KILLOMETER:9036,RADIAN:9101,DEGREE:9102};GeometryService.prototype.buffer=function(a,b,c){var d=prepareGeometryParams_(a);a.bufferSpatialReference&&(d.bufferSR=formatSRParam_(a.bufferSpatialReference)),d.outSR=4326,d.distances=a.distances.join(","),a.unit&&(d.unit=a.unit),getJSON_(this.url+"/buffer",d,"callback",function(d){var e=[];if(d.geometries)for(var f=0,g=d.geometries.length;g>f;f++)e.push(fromJSONToOverlays_(d.geometries[f],a.overlayOptions));d.geometries=e,b(d),handleErr_(c,d)})},GPTask.prototype.execute=function(a,b,c){var d={};a.parameters&&augmentObject_(a.parameters,d),d["env:outSR"]=a.outSpatialReference?formatSRParam_(a.outSpatialReference):4326,a.processSpatialReference&&(d["env:processSR"]=formatSRParam_(a.processSpatialReference)),getJSON_(this.url+"/execute",d,"",function(d){if(d.results)for(var e,f,g=0;g<d.results.length;g++)if(e=d.results[g],"GPFeatureRecordSetLayer"===e.dataType)for(var h=0,i=e.value.features.length;i>h;h++)f=e.value.features[h],f.geometry&&(f.geometry=fromJSONToOverlays_(f.geometry,a.overlayOptions));b(d),handleErr_(c,d)})},RouteTask.prototype.solve=function(a,b,c){if(a){var d=augmentObject_(a,{});isArray_(a.stops)&&(d.stops=fromLatLngsToFeatureSet_(a.stops)),isArray_(a.barriers)&&(a.barriers.length>0?d.barriers=fromLatLngsToFeatureSet_(a.barriers):delete d.barriers),d.returnRoutes=a.returnRoutes===!1?!1:!0,d.returnDirections=a.returnDirections===!0?!0:!1,d.returnBarriers=a.returnBarriers===!0?!0:!1,d.returnStops=a.returnStops===!0?!0:!1,getJSON_(this.url+"/solve",d,"",function(d){d.routes&&parseFeatures_(d.routes.features,a.overlayOptions),b(d),handleErr_(c,d)})}},Projection.prototype.fromLatLngToPoint=function(a,b){if(!a||isNaN(a.lat())||isNaN(a.lng()))return null;var c=this.spatialReference_.forward([a.lng(),a.lat()]),d=b||new G.Point(0,0);return d.x=(c[0]-this.originX_)/this.scale_,d.y=(this.originY_-c[1])/this.scale_,d},Projection.prototype.fromLatLngToPoint=Projection.prototype.fromLatLngToPoint,Projection.prototype.fromPointToLatLng=function(a){if(null===a)return null;var b=a.x*this.scale_+this.originX_,c=this.originY_-a.y*this.scale_,d=this.spatialReference_.inverse([b,c]);return new G.LatLng(d[1],d[0])},Projection.prototype.getScale=function(a){var b=a-this.minZoom,c=0;return this.lods_[b]&&(c=this.lods_[b].scale),c},Projection.WEB_MECATOR=new Projection,TileLayer.prototype.init_=function(a){this.mapService_.tileInfo&&(this.projection_=new Projection(this.mapService_.tileInfo),this.minZoom=a.minZoom||this.projection_.minZoom,this.maxZoom=a.maxZoom||this.projection_.maxZoom)},TileLayer.prototype.getTileUrl=function(a,b){var c=b-(this.projection_?this.projection_.minZoom:this.minZoom),d="";if(!isNaN(a.x)&&!isNaN(a.y)&&c>=0&&a.x>=0&&a.y>=0){var e=this.mapService_.url;this.urlTemplate_&&(e=this.urlTemplate_.replace("["+this.numOfHosts_+"]",""+(a.y+a.x)%this.numOfHosts_));var f=this.projection_||(this.map_?this.map_.getProjection():Projection.WEB_MECATOR);!f instanceof Projection&&(f=Projection.WEB_MECATOR);var g=f.tileSize_,h=1<<b,i=new G.Point(a.x*g.width/h,(a.y+1)*g.height/h),j=new G.Point((a.x+1)*g.width/h,a.y*g.height/h),k=new G.LatLngBounds(f.fromPointToLatLng(i),f.fromPointToLatLng(j)),l=this.mapService_.getFullBounds();if(this.mapService_.singleFusedMapCache===!1||b>this.dynaZoom){var m={f:"image"};m.bounds=k,m.format="png32",m.width=g.width,m.height=g.height,m.imageSR=f.spatialReference_,d=this.mapService_.exportMap(m)}else d=l&&!l.intersects(k)?"":e+"/tile/"+c+"/"+a.y+"/"+a.x}return d},TileLayer.prototype.setOpacity=function(a){this.opacity_=a;var b=this.tiles_;for(var c in b)b.hasOwnProperty(c)&&setNodeOpacity_(b[c],a)},TileLayer.prototype.getOpacity=function(){return this.opacity_},TileLayer.prototype.getMapService=function(){return this.mapService_},MapType.prototype.getTile=function(a,b,c){for(var d=c.createElement("div"),e="_"+a.x+"_"+a.y+"_"+b,f=0;f<this.tileLayers_.length;f++){var g=this.tileLayers_[f];if(b<=g.maxZoom&&b>=g.minZoom){var h=g.getTileUrl(a,b);if(h){var i=c.createElement(document.all?"img":"div");i.style.border="0px none",i.style.margin="0px",i.style.padding="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.width=""+this.tileSize.width+"px",i.style.height=""+this.tileSize.height+"px",document.all?i.src=h:i.style.backgroundImage="url("+h+")",d.appendChild(i),g.tiles_[e]=i,void 0!==g.opacity_?setNodeOpacity_(i,g.opacity_):void 0!==this.opacity_&&setNodeOpacity_(i,this.opacity_)}}}return this.tiles_[e]=d,d.setAttribute("tid",e),d},MapType.prototype.getTile=MapType.prototype.getTile,MapType.prototype.releaseTile=function(a){if(a.getAttribute("tid")){var b=a.getAttribute("tid");this.tiles_[b]&&delete this.tiles_[b];for(var c=0;c<this.tileLayers_.length;c++){var d=this.tileLayers_[c];d.tiles_[b]&&delete d.tiles_[b]}}},MapType.prototype.releaseTile=MapType.prototype.releaseTile,MapType.prototype.setOpacity=function(a){this.opacity_=a;var b=this.tiles_;for(var c in b)if(b.hasOwnProperty(c))for(var d=b[c].childNodes,e=0;e<d.length;e++)setNodeOpacity_(d[e],a)},MapType.prototype.getOpacity=function(){return this.opacity_},MapType.prototype.getTileLayers=function(){return this.tileLayers_},MapOverlay.prototype=new G.OverlayView,MapOverlay.prototype.onAdd=function(){var a=this;this.listeners_.push(G.event.addListener(this.getMap(),"bounds_changed",callback_(this.refresh,this))),this.listeners_.push(G.event.addListener(this.getMap(),"dragstart",function(){a.dragging=!0})),this.listeners_.push(G.event.addListener(this.getMap(),"dragend",function(){a.dragging=!1}));var b=this.getMap();b.agsOverlays=b.agsOverlays||new G.MVCArray,b.agsOverlays.push(this),setCopyrightInfo_(b),this.map_=b},MapOverlay.prototype.onAdd=MapOverlay.prototype.onAdd,MapOverlay.prototype.onRemove=function(){for(var a=0,b=this.listeners_.length;b>a;a++)G.event.removeListener(this.listeners_[a]);this.overlay_&&this.overlay_.setMap(null);var c=this.map_,d=c.agsOverlays;if(d)for(var a=0,e=d.getLength();e>a;a++)if(d.getAt(a)==this){d.removeAt(a);break}setCopyrightInfo_(c),this.map_=null},MapOverlay.prototype.onRemove=MapOverlay.prototype.onRemove,MapOverlay.prototype.draw=function(){this.drawing_&&this.needsNewRefresh_!==!0||this.refresh()},MapOverlay.prototype.draw=MapOverlay.prototype.draw,MapOverlay.prototype.getOpacity=function(){return this.opacity_},MapOverlay.prototype.setOpacity=function(a){var b=Math.min(Math.max(a,0),1);this.opacity_=b,this.overlay_&&setNodeOpacity_(this.overlay_.div_,b)},MapOverlay.prototype.getMapService=function(){return this.mapService_},MapOverlay.prototype.refresh=function(){if(this.drawing_===!0)return void(this.needsNewRefresh_=!0);var a=this.getMap(),b=a?a.getBounds():null;if(b){var c=this.exportOptions_;c.bounds=b;var d=WEB_MERCATOR,e=a.getDiv();if(c.width=e.offsetWidth,c.height=e.offsetHeight,0!=e.offsetWidth&&0!=e.offsetHeight){var f=a.getProjection();f&&f instanceof Projection&&(d=f.spatialReference_),c.imageSR=d,triggerEvent_(this,"drawstart");var g=this;this.drawing_=!0,!this.dragging&&this.overlay_&&(this.overlay_.setMap(null),this.overlay_=null),this.mapService_.exportMap(c,function(a){return g.drawing_=!1,g.needsNewRefresh_===!0?(g.needsNewRefresh_=!1,void g.refresh()):(a.href&&(g.overlay_&&(g.overlay_.setMap(null),g.overlay_=null),g.overlay_=new ImageOverlay(a.bounds,a.href,g.map_,g.opacity_)),void triggerEvent_(g,"drawend"))})}}},MapOverlay.prototype.isHidden=function(){return!(this.visible_&&this.isInZoomRange_())},MapOverlay.prototype.isInZoomRange_=function(){var a=this.getMap().getZoom();
return void 0!==this.minZoom&&a<this.minZoom||void 0!==this.maxZoom&&a>this.maxZoom?!1:!0},MapOverlay.prototype.show=function(){this.visible_=!0,this.div_.style.visibility="visible",this.refresh()},MapOverlay.prototype.hide=function(){this.visible_=!1,this.div_.style.visibility="hidden"},ImageOverlay.prototype=new G.OverlayView,ImageOverlay.prototype.onAdd=function(){var a=document.createElement("DIV");a.style.border="none",a.style.borderWidth="0px",a.style.position="absolute";var b=this.map_.getDiv();a.style.width=b.offsetWidth+"px",a.style.height=b.offsetHeight+"px",a.style.backgroundImage="url("+this.url_+")",this.div_=a;var c=this.getPanes();setNodeOpacity_(a,this.op_),c.overlayLayer.appendChild(a)},ImageOverlay.prototype.draw=function(){var a=this.getProjection(),b=a.fromLatLngToDivPixel(this.bounds_.getSouthWest()),c=a.fromLatLngToDivPixel(this.bounds_.getNorthEast()),d=this.div_;d.style.left=b.x+"px",d.style.top=c.y+"px"},ImageOverlay.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},CopyrightControl.prototype.refresh=function(){setCopyrightInfo_(this.map_)},gmaps.ags={SpatialReference:SpatialReference,Geographic:Geographic,LambertConformalConic:LambertConformalConic,SphereMercator:SphereMercator,TransverseMercator:TransverseMercator,SpatialRelationship:SpatialRelationship,GeometryType:GeometryType,SRUnit:SRUnit,Catalog:Catalog,MapService:MapService,Layer:Layer,GeocodeService:GeocodeService,GeometryService:GeometryService,GPService:GPService,GPTask:GPTask,RouteTask:RouteTask,Util:Util,Config:Config,Projection:Projection,TileLayer:TileLayer,MapOverlay:MapOverlay,MapType:MapType,CopyrightControl:CopyrightControl},window.gmaps=gmaps}(),eval(function(a,b,c,d,e,f){if(e=function(a){return(b>a?"":e(parseInt(a/b)))+((a%=b)>35?String.fromCharCode(a+29):a.toString(36))},!"".replace(/^/,String)){for(;c--;)f[e(c)]=d[c]||e(c);d=[function(a){return f[a]}],e=function(){return"\\w+"},c=1}for(;c--;)d[c]&&(a=a.replace(new RegExp("\\b"+e(c)+"\\b","g"),d[c]));return a}('(B(){8 u=B(a){8 b;2z(a){1w"4p":b="41";1x;1w"3z":b="2x";1x;1w"3j":b="3a";1x;30:b=a}P b};8 t=B(h){8 b;8 a={};A(H.1F&&H.1F.1E){b=h.3v.1F.1E(h,"");A(b){a.D=R(b.2v,10)||0;a.1o=R(b.2p,10)||0;a.C=R(b.2U,10)||0;a.1q=R(b.2O,10)||0;P a}}1c A(H.1A.1z){A(h.1z){a.D=R(u(h.1z.2v),10)||0;a.1o=R(u(h.1z.2p),10)||0;a.C=R(u(h.1z.2U),10)||0;a.1q=R(u(h.1z.2O),10)||0;P a}}a.D=R(h.7["1C-D-G"],10)||0;a.1o=R(h.7["1C-1o-G"],10)||0;a.C=R(h.7["1C-C-G"],10)||0;a.1q=R(h.7["1C-1q-G"],10)||0;P a};8 v={x:0,y:0};8 s=B(e){v.x=(1k H.1A.1M!=="1u"?H.1A.1M:H.28.1M);v.y=(1k H.1A.1R!=="1u"?H.1A.1R:H.28.1R)};s();8 q=B(e){8 a=0,1U=0;e=e||1P.K;A(1k e.2E!=="1u"){a=e.2E;1U=e.39}1c A(1k e.2s!=="1u"){a=e.2s+v.x;1U=e.33+v.y}P{C:a,D:1U}};8 n=B(h){8 e=h.2o;8 g=h.2l;8 b=h.2k;4n(b!==T){A(b!==H.28&&b!==H.1A){e-=b.1M;g-=b.1R}8 m=b;8 f=m.2o;8 a=m.2l;A(!f&&!a&&1P.1E){8 d=H.1F.1E(m,T).46||H.1F.1E(m,T).44;A(d){A(1k d==="43"){8 c=d.3Z(",");f+=R(c[4],10)||0;a+=R(c[5],10)||0}}}e+=f;g+=a;b=b.2k}P{C:e,D:g}};8 o=B(a,b){A(a&&b){1b(8 x 3P b){A(b.3N(x)){a[x]=b[x]}}}P a};8 r=B(h,a){A(1k a!=="1u"){h.7.1y=a}A(1k h.7.1y!=="1u"&&h.7.1y!==""){h.7.3J="3I(1y="+(h.7.1y*3F)+")"}};B U(a,d){8 b=6;8 c=Y F.E.3x();c.3w=B(){b.2C(a,d)};c.3t=B(){};c.3r=B(){};c.2A(a);6.1t=c}U.Q.2C=B(a,c){8 i;8 b=6;6.M=a;c=c||{};6.15=c.3o||"1Q";6.15=6.15.3l();6.W=t(6.M.1a());6.9=[];1b(i=0;i<4;i++){6.9[i]=H.1S("29");6.9[i].3f=B(){P V};o(6.9[i].7,{2b:"38",1y:0.25,2H:"34"});o(6.9[i].7,c.32);o(6.9[i].7,c.31);o(6.9[i].7,{1W:"23",2n:"2m",11:"1h"});A(6.15==="1Q"){6.9[i].7.2Z="1h"}r(6.9[i]);A(6.9[i].7.2b==="2X"){6.9[i].7.2b="2W";r(6.9[i],0)}6.M.1a().2g(6.9[i])}6.2S=c.4l||V;6.22=c.4g||V;6.2P=c.4e||"";6.1Z=c.4b||F.E.4a.47;6.1X=c.45||Y F.E.2N(35,0);6.2f=c.42||T;6.2M=c.40||"3Y"+(H.3X.3W==="3V:"?"s":"")+"://E.3U.3T/3S/3R/1V/3Q.3O";6.Z=c.3M||Y F.E.2N(20,20);6.12=c.3K||{};6.12.1n=6.12.1n||"2L 1G 2c 2K 2J";6.12.1G=6.12.1G||"2L 1n 2c 2K 2J";6.I=H.1S("29");o(6.I.7,{1C:"2x 3E #3C"});o(6.I.7,c.3B);o(6.I.7,{1W:"23",11:"1h"});r(6.I);6.M.1a().2g(6.I);6.1d=t(6.I);6.2a=[F.E.K.19(H,"3A",B(e){b.2F(e)}),F.E.K.19(H,"3y",B(e){b.1T(e)}),F.E.K.19(6.9[0],"1B",B(e){b.1D(e)}),F.E.K.19(6.9[1],"1B",B(e){b.1D(e)}),F.E.K.19(6.9[2],"1B",B(e){b.1D(e)}),F.E.K.19(6.9[3],"1B",B(e){b.1D(e)}),F.E.K.19(H,"1B",B(e){b.2D(e)}),F.E.K.19(H,"3u",B(e){b.1O(e)}),F.E.K.19(H,"3s",B(e){b.2B(e)}),F.E.K.19(1P,"3q",s)];6.13=V;6.1N=V;6.1l=V;6.N=T;6.S=T;6.1r=T;6.14=T;6.27=T;6.1m=T;A(6.22){6.O=6.2y(6.1X);A(6.2f!==T){6.O.3p=6.2f}6.M.1V[6.1Z].3n(6.O);6.2w=6.M.1V[6.1Z].1i-1}};U.Q.2y=B(a){8 b;8 c;8 d=6;b=H.1S("29");b.3m=6.2P;b.7.1W="3k";b.7.2n="2m";b.7.J=6.Z.J+"w";b.7.G=6.Z.G+"w";b.1s=6.12.1n;c=H.1S("3i");c.3h=6.2M;c.7.1W="23";c.7.C=-(6.Z.G*2)+"w";c.7.D=0+"w";b.2g(c);b.3g=B(e){d.13=!d.13;A(d.13){d.O.1v.7.C=-(d.Z.G*0)+"w";d.O.1s=d.12.1G;d.26=1g;F.E.K.1j(d,"2u")}1c{d.O.1v.7.C=-(d.Z.G*2)+"w";d.O.1s=d.12.1n;F.E.K.1j(d,"2t")}d.1O(e)};b.3e=B(){d.O.1v.7.C=-(d.Z.G*1)+"w"};b.3d=B(){A(d.13){d.O.1v.7.C=-(d.Z.G*0)+"w";d.O.1s=d.12.1G}1c{d.O.1v.7.C=-(d.Z.G*2)+"w";d.O.1s=d.12.1n}};b.3c=B(){P V};o(b.7,{2H:"3b",3D:a.J+"w",37:a.G+"w"});P b};U.Q.24=B(e){8 a;e=e||1P.K;a=(e.3G&&6.15==="1Q")||(e.3H&&6.15==="2I")||(e.36&&6.15==="2G");A(!a){2z(e.3L){1w 16:A(6.15==="1Q"){a=1g}1x;1w 17:A(6.15==="2G"){a=1g}1x;1w 18:A(6.15==="2I"){a=1g}1x}}P a};U.Q.2V=B(){8 c=6.27;A(c){8 b=6.1m;8 a=6.M.1a();P c.C>b.C&&c.C<(b.C+a.2r)&&c.D>b.D&&c.D<(b.D+a.2q)}1c{P V}};U.Q.2e=B(){8 i;A(6.M&&6.13&&6.2V()){8 d=6.M.1a();6.1r=d.2r-(6.W.C+6.W.1q);6.14=d.2q-(6.W.D+6.W.1o);A(6.26){8 a=R(6.O.7.C,10)+6.1X.G;8 b=R(6.O.7.D,10)+6.1X.J;8 c=6.Z.G;8 e=6.Z.J;6.9[0].7.D="X";6.9[0].7.C="X";6.9[0].7.G=a+"w";6.9[0].7.J=6.14+"w";6.9[1].7.D="X";6.9[1].7.C=(a+c)+"w";6.9[1].7.G=(6.1r-(a+c))+"w";6.9[1].7.J=6.14+"w";6.9[2].7.D="X";6.9[2].7.C=a+"w";6.9[2].7.G=c+"w";6.9[2].7.J=b+"w";6.9[3].7.D=(b+e)+"w";6.9[3].7.C=a+"w";6.9[3].7.G=c+"w";6.9[3].7.J=(6.14-(b+e))+"w";1b(i=0;i<6.9.1i;i++){6.9[i].7.11="2d"}}1c{6.9[0].7.C="X";6.9[0].7.D="X";6.9[0].7.G=6.1r+"w";6.9[0].7.J=6.14+"w";1b(i=1;i<6.9.1i;i++){6.9[i].7.G="X";6.9[i].7.J="X"}1b(i=0;i<6.9.1i;i++){6.9[i].7.11="2d"}}}1c{1b(i=0;i<6.9.1i;i++){6.9[i].7.11="1h"}}};U.Q.2F=B(e){A(6.M&&!6.13&&6.24(e)){6.1m=n(6.M.1a());6.13=1g;6.26=V;6.2e();F.E.K.1j(6,"2u")}};U.Q.1H=B(e){8 a=q(e);8 p=Y F.E.1p();p.x=a.C-6.1m.C-6.W.C;p.y=a.D-6.1m.D-6.W.D;p.x=L.1e(p.x,6.1r);p.y=L.1e(p.y,6.14);p.x=L.1L(p.x,0);p.y=L.1L(p.y,0);P p};U.Q.1D=B(e){A(6.M&&6.13){6.1m=n(6.M.1a());6.1l=1g;6.N=6.S=6.1H(e);6.I.7.G=6.I.7.J="X";8 a=6.1t.1K();8 b=a.1I(6.N);F.E.K.1j(6,"2Y",b)}};U.Q.2D=B(e){6.1N=1g};U.Q.1O=B(e){6.27=q(e);A(6.1l){6.S=6.1H(e);8 c=L.1e(6.N.x,6.S.x);8 b=L.1e(6.N.y,6.S.y);8 f=L.1f(6.N.x-6.S.x);8 g=L.1f(6.N.y-6.S.y);8 d=L.1L(0,f-(6.1d.C+6.1d.1q));8 a=L.1L(0,g-(6.1d.D+6.1d.1o));6.9[0].7.D="X";6.9[0].7.C="X";6.9[0].7.G=c+"w";6.9[0].7.J=6.14+"w";6.9[1].7.D="X";6.9[1].7.C=(c+f)+"w";6.9[1].7.G=(6.1r-(c+f))+"w";6.9[1].7.J=6.14+"w";6.9[2].7.D="X";6.9[2].7.C=c+"w";6.9[2].7.G=f+"w";6.9[2].7.J=b+"w";6.9[3].7.D=(b+g)+"w";6.9[3].7.C=c+"w";6.9[3].7.G=f+"w";6.9[3].7.J=(6.14-(b+g))+"w";6.I.7.D=b+"w";6.I.7.C=c+"w";6.I.7.G=d+"w";6.I.7.J=a+"w";6.I.7.11="2d";F.E.K.1j(6,"2c",Y F.E.1p(c,b+g),Y F.E.1p(c+f,b),6.1t.1K())}1c A(!6.1N){6.1m=n(6.M.1a());6.2e()}};U.Q.2B=B(e){8 z;8 g=6;6.1N=V;A(6.1l){A((6.1H(e).x===6.N.x)&&(6.1H(e).y===6.N.y)){6.1T(e);P}8 k=L.1e(6.N.x,6.S.x);8 f=L.1e(6.N.y,6.S.y);8 l=L.1f(6.N.x-6.S.x);8 b=L.1f(6.N.y-6.S.y);8 c=1g;A(c){k+=6.W.C;f+=6.W.D}8 m=6.1t.1K();8 d=m.1I(Y F.E.1p(k,f+b));8 j=m.1I(Y F.E.1p(k+l,f));8 h=Y F.E.2j(d,j);A(6.2S){6.I.7.11="1h"}1c{z=6.M.2T();6.M.4m(h);A(6.M.2T()<z){6.M.4j(z)}8 a=m.2R(d);8 i=m.2R(j);A(c){a.x-=6.W.C;a.y-=6.W.D;i.x-=6.W.C;i.y-=6.W.D}6.I.7.C=a.x+"w";6.I.7.D=i.y+"w";6.I.7.G=(L.1f(i.x-a.x)-(6.1d.C+6.1d.1q))+"w";6.I.7.J=(L.1f(i.y-a.y)-(6.1d.D+6.1d.1o))+"w";4i(B(){g.I.7.11="1h"},4h)}6.1l=V;6.1O(e);F.E.K.1j(6,"4f",h);A(!6.24(e)){6.1T(e)}}};U.Q.1T=B(e){8 i;8 b,D,G,J,1Y,2h,2i;8 a=T;A(6.M&&6.13){6.13=V;A(6.1l){6.I.7.11="1h";6.1l=V;b=L.1e(6.N.x,6.S.x);D=L.1e(6.N.y,6.S.y);G=L.1f(6.N.x-6.S.x);J=L.1f(6.N.y-6.S.y);1Y=6.1t.1K();2h=1Y.1I(Y F.E.1p(b,D+J));2i=1Y.1I(Y F.E.1p(b+G,D));a=Y F.E.2j(2h,2i)}1b(i=0;i<6.9.1i;i++){6.9[i].7.11="1h"}A(6.22){6.O.1v.7.C=-(6.Z.G*2)+"w";6.O.1s=6.12.1n;6.O.7.11=""}F.E.K.1j(6,"2t",a)}};F.E.21.Q.4d=B(a){6.1J=Y U(6,a)};F.E.21.Q.4c=B(){8 i;8 d=6.1J;A(d){1b(i=0;i<d.2a.1i;++i){F.E.K.4k(d.2a[i])}6.1a().2Q(d.I);1b(i=0;i<d.9.1i;i++){6.1a().2Q(d.9[i])}A(d.22){6.1V[d.1Z].49(d.2w)}d.1t.2A(T);6.1J=T}};F.E.21.Q.48=B(){P 6.1J!==T};F.E.21.Q.4o=B(){P 6.1J}})();',62,274,"||||||this|style|var|veilDiv_|||||||||||||||||||||||px||||if|function|left|top|maps|google|width|document|boxDiv_|height|event|Math|map_|startPt_|buttonDiv_|return|prototype|parseInt|endPt_|null|DragZoom|false|borderWidths_|0px|new|visualSize_||display|visualTips_|hotKeyDown_|mapHeight_|key_||||addDomListener|getDiv|for|else|boxBorderWidths_|min|abs|true|none|length|trigger|typeof|dragging_|mapPosn_|off|bottom|Point|right|mapWidth_|title|prjov_|undefined|firstChild|case|break|opacity|currentStyle|documentElement|mousedown|border|onMouseDown_|getComputedStyle|defaultView|on|getMousePoint_|fromContainerPixelToLatLng|dragZoom_|getProjection|max|scrollLeft|mouseDown_|onMouseMove_|window|shift|scrollTop|createElement|onKeyUp_|posY|controls|position|visualPositionOffset_|prj|visualPosition_||Map|visualEnabled_|absolute|isHotKeyDown_||activatedByControl_|mousePosn_|body|div|listeners_|backgroundColor|drag|block|setVeilVisibility_|visualPositionIndex_|appendChild|sw|ne|LatLngBounds|offsetParent|offsetTop|hidden|overflow|offsetLeft|borderBottomWidth|offsetHeight|offsetWidth|clientX|deactivate|activate|borderTopWidth|controlIndex_|4px|initControl_|switch|setMap|onMouseUp_|init_|onMouseDownDocument_|pageX|onKeyDown_|ctrl|cursor|alt|mode|zoom|Turn|visualSprite_|Size|borderRightWidth|visualClass_|removeChild|fromLatLngToContainerPixel|noZoom_|getZoom|borderLeftWidth|isMouseOnMap_|white|transparent|dragstart|MozUserSelect|default|veilStyle|paneStyle|clientY|crosshair||ctrlKey|marginLeft|gray|pageY|6px|pointer|ondragstart|onmouseout|onmouseover|onselectstart|onclick|src|img|thick|relative|toLowerCase|className|push|key|index|scroll|onRemove|mouseup|draw|mousemove|ownerDocument|onAdd|OverlayView|keyup|medium|keydown|boxStyle|736AFF|marginTop|solid|100|shiftKey|altKey|alpha|filter|visualTips|keyCode|visualSize|hasOwnProperty|png|in|dragzoom_btn|ftr|mapfiles|com|gstatic|https|protocol|location|http|split|visualSprite|2px|visualPositionIndex|string|WebkitTransform|visualPositionOffset|MozTransform|LEFT_TOP|keyDragZoomEnabled|removeAt|ControlPosition|visualPosition|disableKeyDragZoom|enableKeyDragZoom|visualClass|dragend|visualEnabled|1000|setTimeout|setZoom|removeListener|noZoom|fitBounds|while|getDragZoomObject|thin".split("|"),0,{})),MarkerManager.prototype.initialize=function(a,b){var c=this;b=b||{},c.tileSize_=MarkerManager.DEFAULT_TILE_SIZE_;var d=a.mapTypes,e=1;for(var f in d)if(d.hasOwnProperty(f)&&d.get(f)&&"number"===d.get(f).maxZoom){var g=a.mapTypes.get(f).maxZoom;g>e&&(e=g)}c.maxZoom_=b.maxZoom||19,c.trackMarkers_=b.trackMarkers,c.show_=b.show||!0;var h;h="number"==typeof b.borderPadding?b.borderPadding:MarkerManager.DEFAULT_BORDER_PADDING_,c.swPadding_=new google.maps.Size(-h,h),c.nePadding_=new google.maps.Size(h,-h),c.borderPadding_=h,c.gridWidth_={},c.grid_={},c.grid_[c.maxZoom_]={},c.numMarkers_={},c.numMarkers_[c.maxZoom_]=0,google.maps.event.addListener(a,"dragend",function(){c.onMapMoveEnd_()}),google.maps.event.addListener(a,"idle",function(){c.onMapMoveEnd_()}),google.maps.event.addListener(a,"zoom_changed",function(){c.onMapMoveEnd_()}),c.removeOverlay_=function(a){a.setMap(null),c.shownMarkers_--},c.addOverlay_=function(a){c.show_&&(a.setMap(c.map_),c.shownMarkers_++)},c.resetManager_(),c.shownMarkers_=0,c.shownBounds_=c.getMapGridBounds_(),google.maps.event.trigger(c,"loaded")},MarkerManager.DEFAULT_TILE_SIZE_=1024,MarkerManager.DEFAULT_BORDER_PADDING_=100,MarkerManager.MERCATOR_ZOOM_LEVEL_ZERO_RANGE=256,MarkerManager.prototype.resetManager_=function(){for(var a=MarkerManager.MERCATOR_ZOOM_LEVEL_ZERO_RANGE,b=0;b<=this.maxZoom_;++b)this.grid_[b]={},this.numMarkers_[b]=0,this.gridWidth_[b]=Math.ceil(a/this.tileSize_),a<<=1},MarkerManager.prototype.clearMarkers=function(){this.processAll_(this.shownBounds_,this.removeOverlay_),this.resetManager_()},MarkerManager.prototype.getTilePoint_=function(a,b,c){var d=this.projectionHelper_.LatLngToPixel(a,b),e=new google.maps.Point(Math.floor((d.x+c.width)/this.tileSize_),Math.floor((d.y+c.height)/this.tileSize_));return e},MarkerManager.prototype.addMarkerBatch_=function(a,b,c){var d=this,e=a.getPosition();a.MarkerManager_minZoom=b,this.trackMarkers_&&google.maps.event.addListener(a,"changed",function(a,b,c){d.onMarkerMoved_(a,b,c)});for(var f=this.getTilePoint_(e,c,new google.maps.Size(0,0,0,0)),g=c;g>=b;g--){var h=this.getGridCellCreate_(f.x,f.y,g);h.push(a),f.x=f.x>>1,f.y=f.y>>1}},MarkerManager.prototype.isGridPointVisible_=function(a){var b=this.shownBounds_.minY<=a.y&&a.y<=this.shownBounds_.maxY,c=this.shownBounds_.minX,d=c<=a.x&&a.x<=this.shownBounds_.maxX;if(!d&&0>c){var e=this.gridWidth_[this.shownBounds_.z];d=c+e<=a.x&&a.x<=e-1}return b&&d},MarkerManager.prototype.onMarkerMoved_=function(a,b,c){for(var d=this.maxZoom_,e=!1,f=this.getTilePoint_(b,d,new google.maps.Size(0,0,0,0)),g=this.getTilePoint_(c,d,new google.maps.Size(0,0,0,0));d>=0&&(f.x!==g.x||f.y!==g.y);){var h=this.getGridCellNoCreate_(f.x,f.y,d);h&&this.removeFromArray_(h,a)&&this.getGridCellCreate_(g.x,g.y,d).push(a),d===this.mapZoom_&&(this.isGridPointVisible_(f)?this.isGridPointVisible_(g)||(this.removeOverlay_(a),e=!0):this.isGridPointVisible_(g)&&(this.addOverlay_(a),e=!0)),f.x=f.x>>1,f.y=f.y>>1,g.x=g.x>>1,g.y=g.y>>1,--d}e&&this.notifyListeners_()},MarkerManager.prototype.removeMarker=function(a){for(var b=this.maxZoom_,c=!1,d=a.getPosition(),e=this.getTilePoint_(d,b,new google.maps.Size(0,0,0,0));b>=0;){var f=this.getGridCellNoCreate_(e.x,e.y,b);f&&this.removeFromArray_(f,a),b===this.mapZoom_&&this.isGridPointVisible_(e)&&(this.removeOverlay_(a),c=!0),e.x=e.x>>1,e.y=e.y>>1,--b}c&&this.notifyListeners_(),this.numMarkers_[a.MarkerManager_minZoom]--},MarkerManager.prototype.addMarkers=function(a,b,c){for(var d=this.getOptMaxZoom_(c),e=a.length-1;e>=0;e--)this.addMarkerBatch_(a[e],b,d);this.numMarkers_[b]+=a.length},MarkerManager.prototype.getOptMaxZoom_=function(a){return a||this.maxZoom_},MarkerManager.prototype.getMarkerCount=function(a){for(var b=0,c=0;a>=c;c++)b+=this.numMarkers_[c];return b},MarkerManager.prototype.getMarker=function(a,b,c){var d=new google.maps.LatLng(a,b),e=this.getTilePoint_(d,c,new google.maps.Size(0,0,0,0)),f=new google.maps.Marker({position:d}),g=this.getGridCellNoCreate_(e.x,e.y,c);if(void 0!==g)for(var h=0;h<g.length;h++)a===g[h].getPosition().lat()&&b===g[h].getPosition().lng()&&(f=g[h]);return f},MarkerManager.prototype.addMarker=function(a,b,c){var d=this.getOptMaxZoom_(c);this.addMarkerBatch_(a,b,d);var e=this.getTilePoint_(a.getPosition(),this.mapZoom_,new google.maps.Size(0,0,0,0));this.isGridPointVisible_(e)&&b<=this.shownBounds_.z&&this.shownBounds_.z<=d&&(this.addOverlay_(a),this.notifyListeners_()),this.numMarkers_[b]++},GridBounds.prototype.equals=function(a){return this.maxX===a.maxX&&this.maxY===a.maxY&&this.minX===a.minX&&this.minY===a.minY?!0:!1},GridBounds.prototype.containsPoint=function(a){var b=this;return b.minX<=a.x&&b.maxX>=a.x&&b.minY<=a.y&&b.maxY>=a.y},MarkerManager.prototype.getGridCellCreate_=function(a,b,c){var d=this.grid_[c];0>a&&(a+=this.gridWidth_[c]);var e=d[a];if(!e)return e=d[a]=[],e[b]=[];var f=e[b];return f?f:e[b]=[]},MarkerManager.prototype.getGridCellNoCreate_=function(a,b,c){var d=this.grid_[c];0>a&&(a+=this.gridWidth_[c]);var e=d[a];return e?e[b]:void 0},MarkerManager.prototype.getGridBounds_=function(a,b,c,d){b=Math.min(b,this.maxZoom_);var e=a.getSouthWest(),f=a.getNorthEast(),g=this.getTilePoint_(e,b,c),h=this.getTilePoint_(f,b,d),i=this.gridWidth_[b];(f.lng()<e.lng()||h.x<g.x)&&(g.x-=i),h.x-g.x+1>=i&&(g.x=0,h.x=i-1);var j=new GridBounds([g,h]);return j.z=b,j},MarkerManager.prototype.getMapGridBounds_=function(){return this.getGridBounds_(this.map_.getBounds(),this.mapZoom_,this.swPadding_,this.nePadding_)},MarkerManager.prototype.onMapMoveEnd_=function(){this.objectSetTimeout_(this,this.updateMarkers_,0)},MarkerManager.prototype.objectSetTimeout_=function(a,b,c){return window.setTimeout(function(){b.call(a)},c)},MarkerManager.prototype.visible=function(){return this.show_?!0:!1},MarkerManager.prototype.isHidden=function(){return!this.show_},MarkerManager.prototype.show=function(){this.show_=!0,this.refresh()},MarkerManager.prototype.hide=function(){this.show_=!1,this.refresh()},MarkerManager.prototype.toggle=function(){this.show_=!this.show_,this.refresh()},MarkerManager.prototype.refresh=function(){this.shownMarkers_>0&&this.processAll_(this.shownBounds_,this.removeOverlay_),this.show_&&this.processAll_(this.shownBounds_,this.addOverlay_),this.notifyListeners_()},MarkerManager.prototype.updateMarkers_=function(){this.mapZoom_=this.map_.getZoom();var a=this.getMapGridBounds_();a.equals(this.shownBounds_)&&a.z===this.shownBounds_.z||(a.z!==this.shownBounds_.z?(this.processAll_(this.shownBounds_,this.removeOverlay_),this.show_&&this.processAll_(a,this.addOverlay_)):(this.rectangleDiff_(this.shownBounds_,a,this.removeCellMarkers_),this.show_&&this.rectangleDiff_(a,this.shownBounds_,this.addCellMarkers_)),this.shownBounds_=a,this.notifyListeners_())},MarkerManager.prototype.notifyListeners_=function(){google.maps.event.trigger(this,"changed",this.shownBounds_,this.shownMarkers_)},MarkerManager.prototype.processAll_=function(a,b){for(var c=a.minX;c<=a.maxX;c++)for(var d=a.minY;d<=a.maxY;d++)this.processCellMarkers_(c,d,a.z,b)},MarkerManager.prototype.processCellMarkers_=function(a,b,c,d){var e=this.getGridCellNoCreate_(a,b,c);if(e)for(var f=e.length-1;f>=0;f--)d(e[f])},MarkerManager.prototype.removeCellMarkers_=function(a,b,c){this.processCellMarkers_(a,b,c,this.removeOverlay_)},MarkerManager.prototype.addCellMarkers_=function(a,b,c){this.processCellMarkers_(a,b,c,this.addOverlay_)},MarkerManager.prototype.rectangleDiff_=function(a,b,c){var d=this;d.rectangleDiffCoords_(a,b,function(b,e){c.apply(d,[b,e,a.z])})},MarkerManager.prototype.rectangleDiffCoords_=function(a,b,c){var d,e,f=a.minX,g=a.minY,h=a.maxX,i=a.maxY,j=b.minX,k=b.minY,l=b.maxX,m=b.maxY;for(d=f;h>=d;d++){for(e=g;i>=e&&k>e;e++)c(d,e);for(e=Math.max(m+1,g);i>=e;e++)c(d,e)}for(e=Math.max(g,k);e<=Math.min(i,m);e++){for(d=Math.min(h+1,j)-1;d>=f;d--)c(d,e);for(d=Math.max(f,l+1);h>=d;d++)c(d,e)}},MarkerManager.prototype.removeFromArray_=function(a,b,c){for(var d=0,e=0;e<a.length;++e)(a[e]===b||c&&a[e]===b)&&(a.splice(e--,1),d++);return d},ProjectionHelperOverlay.prototype=new google.maps.OverlayView,ProjectionHelperOverlay.prototype.LngToX_=function(a){return 1+a/180},ProjectionHelperOverlay.prototype.LatToY_=function(a){var b=Math.sin(a*Math.PI/180);return 1-.5/Math.PI*Math.log((1+b)/(1-b))},ProjectionHelperOverlay.prototype.LatLngToPixel=function(a,b){var c=(this._map,this.getProjection().fromLatLngToDivPixel(a),{x:~~(.5+this.LngToX_(a.lng())*(2<<b+6)),y:~~(.5+this.LatToY_(a.lat())*(2<<b+6))});return c},ProjectionHelperOverlay.prototype.draw=function(){this.ready||(this.ready=!0,google.maps.event.trigger(this,"ready"))},ClusterIcon.prototype.onAdd=function(){var a,b,c=this;this.div_=document.createElement("div"),this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),google.maps.event.addListener(this.getMap(),"bounds_changed",function(){b=a}),google.maps.event.addDomListener(this.div_,"mousedown",function(){a=!0,b=!1}),google.maps.event.addDomListener(this.div_,"click",function(d){if(a=!1,!b){var e,f=c.cluster_.getMarkerClusterer();google.maps.event.trigger(f,"click",c.cluster_),google.maps.event.trigger(f,"clusterclick",c.cluster_),f.getZoomOnClick()&&(e=f.getMaxZoom(),f.getMap().fitBounds(c.cluster_.getBounds()),null!==e&&f.getMap().getZoom()>e&&f.getMap().setZoom(e+1)),d.cancelBubble=!0,d.stopPropagation&&d.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var a=c.cluster_.getMarkerClusterer();google.maps.event.trigger(a,"mouseover",c.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var a=c.cluster_.getMarkerClusterer();google.maps.event.trigger(a,"mouseout",c.cluster_)})},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.draw=function(){if(this.visible_){var a=this.getPosFromLatLng_(this.center_);this.div_.style.top=a.y+"px",this.div_.style.left=a.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var a=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(a),this.div_.innerHTML=this.cluster_.printable_?"<img src='"+this.url_+"'><div style='position: absolute; top: 0px; left: 0px; width: "+this.width_+"px;'>"+this.sums_.text+"</div>":this.sums_.text,this.div_.title=this.cluster_.getMarkerClusterer().getTitle(),this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.useStyle=function(a){this.sums_=a;var b=Math.max(0,a.index-1);b=Math.min(this.styles_.length-1,b);var c=this.styles_[b];this.url_=c.url,this.height_=c.height,this.width_=c.width,this.anchor_=c.anchor,this.anchorIcon_=c.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=c.textColor||"black",this.textSize_=c.textSize||11,this.textDecoration_=c.textDecoration||"none",this.fontWeight_=c.fontWeight||"bold",this.fontStyle_=c.fontStyle||"normal",this.fontFamily_=c.fontFamily||"Arial,sans-serif",this.backgroundPosition_=c.backgroundPosition||"0 0"},ClusterIcon.prototype.setCenter=function(a){this.center_=a},ClusterIcon.prototype.createCss=function(a){var b=[];return this.cluster_.printable_||(b.push("background-image:url("+this.url_+");"),b.push("background-position:"+this.backgroundPosition_+";")),"object"==typeof this.anchor_?(b.push("number"==typeof this.anchor_[0]&&this.anchor_[0]>0&&this.anchor_[0]<this.height_?"height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;":"height:"+this.height_+"px; line-height:"+this.height_+"px;"),b.push("number"==typeof this.anchor_[1]&&this.anchor_[1]>0&&this.anchor_[1]<this.width_?"width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;":"width:"+this.width_+"px; text-align:center;")):b.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;"),b.push("cursor:pointer; top:"+a.y+"px; left:"+a.x+"px; color:"+this.textColor_+"; position:absolute; font-size:"+this.textSize_+"px; font-family:"+this.fontFamily_+"; font-weight:"+this.fontWeight_+"; font-style:"+this.fontStyle_+"; text-decoration:"+this.textDecoration_+";"),b.join("")},ClusterIcon.prototype.getPosFromLatLng_=function(a){var b=this.getProjection().fromLatLngToDivPixel(a);return b.x-=this.anchorIcon_[1],b.y-=this.anchorIcon_[0],b},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){var a,b=new google.maps.LatLngBounds(this.center_,this.center_),c=this.getMarkers();for(a=0;a<c.length;a++)b.extend(c[a].getPosition());return b},Cluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},Cluster.prototype.addMarker=function(a){var b,c,d;if(this.isMarkerAlreadyAdded_(a))return!1;if(this.center_){if(this.averageCenter_){var e=this.markers_.length+1,f=(this.center_.lat()*(e-1)+a.getPosition().lat())/e,g=(this.center_.lng()*(e-1)+a.getPosition().lng())/e;this.center_=new google.maps.LatLng(f,g),this.calculateBounds_()}}else this.center_=a.getPosition(),this.calculateBounds_();if(a.isAdded=!0,this.markers_.push(a),c=this.markers_.length,d=this.markerClusterer_.getMaxZoom(),null!==d&&this.map_.getZoom()>d)a.getMap()!==this.map_&&a.setMap(this.map_);else if(c<this.minClusterSize_)a.getMap()!==this.map_&&a.setMap(this.map_);else if(c===this.minClusterSize_)for(b=0;c>b;b++)this.markers_[b].setMap(null);else a.setMap(null);return this.updateIcon_(),!0},Cluster.prototype.isMarkerInClusterBounds=function(a){return this.bounds_.contains(a.getPosition())},Cluster.prototype.calculateBounds_=function(){var a=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(a)},Cluster.prototype.updateIcon_=function(){var a=this.markers_.length,b=this.markerClusterer_.getMaxZoom();if(null!==b&&this.map_.getZoom()>b)return void this.clusterIcon_.hide();if(a<this.minClusterSize_)return void this.clusterIcon_.hide();var c=this.markerClusterer_.getStyles().length,d=this.markerClusterer_.getCalculator()(this.markers_,c);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(d),this.clusterIcon_.show()},Cluster.prototype.isMarkerAlreadyAdded_=function(a){var b;if(this.markers_.indexOf)return-1!==this.markers_.indexOf(a);for(b=0;b<this.markers_.length;b++)if(a===this.markers_[b])return!0;return!1},MarkerClusterer.prototype.onAdd=function(){var a=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){a.resetViewport_(!1),0===this.getZoom()&&google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){a.redraw_()})]},MarkerClusterer.prototype.onRemove=function(){var a;for(a=0;a<this.markers_.length;a++)this.markers_[a].setMap(this.activeMap_);for(a=0;a<this.clusters_.length;a++)this.clusters_[a].remove();for(this.clusters_=[],a=0;a<this.listeners_.length;a++)google.maps.event.removeListener(this.listeners_[a]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){var a,b;if(!(this.styles_.length>0))for(a=0;a<this.imageSizes_.length;a++)b=this.imageSizes_[a],this.styles_.push({url:this.imagePath_+(a+1)+"."+this.imageExtension_,height:b,width:b})},MarkerClusterer.prototype.fitMapToMarkers=function(){var a,b=this.getMarkers(),c=new google.maps.LatLngBounds;for(a=0;a<b.length;a++)c.extend(b[a].getPosition());this.getMap().fitBounds(c)},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(a){this.gridSize_=a},MarkerClusterer.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinimumClusterSize=function(a){this.minClusterSize_=a},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.setMaxZoom=function(a){this.maxZoom_=a},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.setStyles=function(a){this.styles_=a},MarkerClusterer.prototype.getTitle=function(){return this.title_},MarkerClusterer.prototype.setTitle=function(a){this.title_=a},MarkerClusterer.prototype.getZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.setZoomOnClick=function(a){this.zoomOnClick_=a},MarkerClusterer.prototype.getAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.setAverageCenter=function(a){this.averageCenter_=a},MarkerClusterer.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},MarkerClusterer.prototype.setIgnoreHidden=function(a){this.ignoreHidden_=a},MarkerClusterer.prototype.getImageExtension=function(){return this.imageExtension_},MarkerClusterer.prototype.setImageExtension=function(a){this.imageExtension_=a},MarkerClusterer.prototype.getImagePath=function(){return this.imagePath_},MarkerClusterer.prototype.setImagePath=function(a){this.imagePath_=a},MarkerClusterer.prototype.getImageSizes=function(){return this.imageSizes_},MarkerClusterer.prototype.setImageSizes=function(a){this.imageSizes_=a},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.setCalculator=function(a){this.calculator_=a},MarkerClusterer.prototype.getPrintable=function(){return this.printable_},MarkerClusterer.prototype.setPrintable=function(a){this.printable_=a},MarkerClusterer.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},MarkerClusterer.prototype.setBatchSizeIE=function(a){this.batchSizeIE_=a},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.getClusters=function(){return this.clusters_},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.addMarker=function(a,b){this.pushMarkerTo_(a),b||this.redraw_()},MarkerClusterer.prototype.addMarkers=function(a,b){var c;for(c=0;c<a.length;c++)this.pushMarkerTo_(a[c]);b||this.redraw_()},MarkerClusterer.prototype.pushMarkerTo_=function(a){if(a.getDraggable()){var b=this;google.maps.event.addListener(a,"dragend",function(){b.ready_&&(this.isAdded=!1,b.repaint())})}a.isAdded=!1,this.markers_.push(a)},MarkerClusterer.prototype.removeMarker=function(a,b){var c=this.removeMarker_(a);return!b&&c&&this.repaint(),c},MarkerClusterer.prototype.removeMarkers=function(a,b){var c,d,e=!1;for(c=0;c<a.length;c++)d=this.removeMarker_(a[c]),e=e||d;return!b&&e&&this.repaint(),e},MarkerClusterer.prototype.removeMarker_=function(a){var b,c=-1;if(this.markers_.indexOf)c=this.markers_.indexOf(a);else for(b=0;b<this.markers_.length;b++)if(a===this.markers_[b]){c=b;break}return-1===c?!1:(a.setMap(null),this.markers_.splice(c,1),!0)},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},MarkerClusterer.prototype.repaint=function(){var a=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var b;for(b=0;b<a.length;b++)a[b].remove()},0)},MarkerClusterer.prototype.getExtendedBounds=function(a){var b=this.getProjection(),c=new google.maps.LatLng(a.getNorthEast().lat(),a.getNorthEast().lng()),d=new google.maps.LatLng(a.getSouthWest().lat(),a.getSouthWest().lng()),e=b.fromLatLngToDivPixel(c);e.x+=this.gridSize_,e.y-=this.gridSize_;var f=b.fromLatLngToDivPixel(d);f.x-=this.gridSize_,f.y+=this.gridSize_;var g=b.fromDivPixelToLatLng(e),h=b.fromDivPixelToLatLng(f);return a.extend(g),a.extend(h),a},MarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},MarkerClusterer.prototype.resetViewport_=function(a){var b,c;for(b=0;b<this.clusters_.length;b++)this.clusters_[b].remove();for(this.clusters_=[],b=0;b<this.markers_.length;b++)c=this.markers_[b],c.isAdded=!1,a&&c.setMap(null)},MarkerClusterer.prototype.distanceBetweenPoints_=function(a,b){var c=6371,d=(b.lat()-a.lat())*Math.PI/180,e=(b.lng()-a.lng())*Math.PI/180,f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(a.lat()*Math.PI/180)*Math.cos(b.lat()*Math.PI/180)*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),h=c*g;return h},MarkerClusterer.prototype.isMarkerInBounds_=function(a,b){return b.contains(a.getPosition())},MarkerClusterer.prototype.addToClosestCluster_=function(a){var b,c,d,e,f=4e4,g=null;for(b=0;b<this.clusters_.length;b++)d=this.clusters_[b],e=d.getCenter(),e&&(c=this.distanceBetweenPoints_(e,a.getPosition()),f>c&&(f=c,g=d));g&&g.isMarkerInClusterBounds(a)?g.addMarker(a):(d=new Cluster(this),d.addMarker(a),this.clusters_.push(d))},MarkerClusterer.prototype.createClusters_=function(a){var b,c,d,e=this;if(this.ready_){0===a&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),d=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));
var f=this.getExtendedBounds(d),g=Math.min(a+this.batchSize_,this.markers_.length);for(b=a;g>b;b++)c=this.markers_[b],!c.isAdded&&this.isMarkerInBounds_(c,f)&&(!this.ignoreHidden_||this.ignoreHidden_&&c.getVisible())&&this.addToClosestCluster_(c);g<this.markers_.length?this.timerRefStatic=setTimeout(function(){e.createClusters_(g)},0):(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this))}},MarkerClusterer.prototype.extend=function(a,b){return function(a){var b;for(b in a.prototype)this.prototype[b]=a.prototype[b];return this}.apply(a,[b])},MarkerClusterer.CALCULATOR=function(a,b){for(var c=0,d=a.length.toString(),e=d;0!==e;)e=parseInt(e/10,10),c++;return c=Math.min(c,b),{text:d,index:c}},MarkerClusterer.BATCH_SIZE=2e3,MarkerClusterer.BATCH_SIZE_IE=500,MarkerClusterer.IMAGE_PATH="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m",MarkerClusterer.IMAGE_EXTENSION="png",MarkerClusterer.IMAGE_SIZES=[53,56,66,78,90];var searching,willshow,selectedShape,stationicon=new google.maps.MarkerImage("images/noaa32x32.png"),stationiconHOVER=new google.maps.MarkerImage("images/4875095d.noaa32x32-hover.png"),app={};app.loaded={},app.layers=app.layers||{};var initialCenter,initialZoom=3,initialBounds,placesService,selectedShape,deleteAllShapes,popup;window.onload=startApp;